<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Typing Lesson Board</title>
  <style>
    body {
      margin: 0;
      background-color: #1e1e1e;
      color: #d4d4d4;
      font-family: 'Courier New', monospace;
      overflow: hidden;
    }
    .code-board {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .code-container {
      background-color: #1e1e1e;
      border-radius: 8px;
      padding: 40px;
      width: 80%;
      max-width: 900px;
      box-shadow: 0 0 12px rgba(0,0,0,0.5);
    }
    .code-line {
      display: flex;
      font-size: 18px;
    }
    .line-number {
      width: 30px;
      color: #858585;
      text-align: right;
      margin-right: 20px;
    }
    .code-text span.correct.keyword { color: #569CD6; }
    .code-text span.correct.func { color: #DCDCAA; }
    .code-text span.correct.str { color: #CE9178; }
    .code-text span.correct.var { color: #9CDCFE; }
    .code-text span.wrong { color: red; }
    .progress-container {
      height: 8px;
      background: #444;
      width: 100%;
    }
    .progress-bar {
      height: 8px;
      background: #4caf50;
      width: 0%;
      transition: width 0.2s;
    }
    .step-buttons {
      display: flex;
      justify-content: center;
      margin: 20px 0;
      gap: 12px;
    }
    .step-circle {
      background-color: #1e90ff;
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: transform 0.2s, background-color 0.3s;
    }
    .step-circle:hover {
      background-color: #63b3ed;
      transform: scale(1.1);
    }
  </style>
</head>
<body>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div class="step-buttons">
    <button class="step-circle" onclick="showStep(1)">1</button>
    <button class="step-circle" onclick="showStep(2)">2</button>
    <button class="step-circle" onclick="showStep(3)">3</button>
    <button class="step-circle" onclick="showStep(4)">4</button>
    <button class="step-circle" onclick="showStep(5)">5</button>
    <button class="step-circle" onclick="showStep(6)">6</button>
  </div>
  <div id="step-1">
    <div style="text-align:center; padding: 20px;">
      <h3>Petualangan Baru Dimulai!</h3>
      <p>
        Halo, Penjelajah Kecil! ðŸŒŸ<br>
        Di langkah pertama ini, kamu akan mulai menulis kode layaknya penyihir komputer! Tapi ini baru permulaan.
      </p>
      <p>
        Yuk ikuti langkah-langkah seru berikutnya:<br>
        ðŸ§  Di Langkah 2, kita ajak komputer ngobrol!<br>
        ðŸ”¢ Di Langkah 3, kita ubah jawaban jadi angka.<br>
        ðŸš€ Di Langkah 4, waktunya menghitung perjalanan.<br>
        ðŸŽ‰ Di Langkah 5, kita tunjukkan hasilnya.<br>
        ðŸ§ª Dan di Langkah 6, kamu bisa coba jalankan semua kode yang kamu buat!
      </p>
      <p>
        Ayo mulai petualanganmu dan lanjutkan ke langkah berikutnya setelah kamu menyelesaikan tantangan di sini! ðŸ’»âœ¨
      </p>
    </div>
    <div class="code-board">
      <div class="code-container" id="codeContainer">
        <!-- Lines will be injected here by JS -->
      </div>
    </div>
  </div>
  <div id="step-2" style="display:none;">
    <div class="code-board">
      <div class="code-container">
        <h3>Langkah 2: Ajak Komputer Bertanya!</h3>
        <div>
          <p>Di langkah ini, kita akan ajak komputer untuk bertanya ke kita! Misalnya, komputer bisa nanya: "Tanggal berapa hari ini?" dan kita jawab lewat keyboard. Komputer akan simpan jawaban kita supaya bisa dipakai nanti!</p>
        </div>
        <div id="codeContainer2">
          <!-- Typing exercise for step 2 will be rendered here -->
        </div>
      </div>
    </div>
  </div>
  <div id="step-3" style="display:none;">
    <div class="code-board">
      <div class="code-container">
        <h3>Langkah 3: Ubah Jawaban Jadi Angka</h3>
        <p>Setelah komputer dapat jawaban dari kita, kadang jawabannya harus diubah dulu. Misalnya, kalau kita jawab "5", komputer harus tahu itu angka lima, bukan cuma tulisan. Kita bisa bantu komputer dengan perintah <code>int()</code>!</p>
        <div id="codeContainer3"></div>
      </div>
    </div>
  </div>
  <div id="step-4" style="display:none;">
    <div class="code-board">
      <div class="code-container">
        <h3>Langkah 4: Hitung Bareng Komputer</h3>
        <p>Sekarang waktunya kita main hitung-hitungan bareng komputer! Kita bisa pakai data tadi buat cari hasil, misalnya berapa lama perjalanan kalau kecepatan 10 km per jam.</p>
        <div id="codeContainer4"></div>
      </div>
    </div>
  </div>
  <div id="step-5" style="display:none;">
    <div class="code-board">
      <div class="code-container">
        <h3>Langkah 5: Tunjukkan Jawaban!</h3>
        <p>Kalau semuanya udah siap, sekarang saatnya komputer nunjukin jawabannya ke kita. Gunakan <code>print()</code> biar bisa tampil di layar, kayak bilang "Tadaaa!"</p>
        <div id="codeContainer5"></div>
      </div>
    </div>
  </div>
  <div id="step-6" style="display:none;">
    <div class="code-board">
      <div class="code-container" style="text-align:center;">
        <h3>Langkah 6: Jalankan Programmu!</h3>
        <p>Sekarang kita coba program yang sudah kamu tulis! Klik tombol di bawah ini untuk menjalankan programmu dan lihat hasilnya muncul!</p>
        <button onclick="runFinalProgram()" style="margin-top:20px; padding:12px 24px; font-size:16px; background:#4caf50; color:white; border:none; border-radius:6px; cursor:pointer;">Jalankan Program</button>
        <pre id="outputResult" style="margin-top:24px; background:#111; color:#4caf50; padding:16px; border-radius:8px; font-size:16px;"></pre>
      </div>
    </div>
  </div>

<script>
  // Step navigation logic
  function showStep(n) {
    for (let i = 1; i <= 6; i++) {
      const div = document.getElementById('step-' + i);
      if (div) div.style.display = (i === n) ? 'block' : 'none';
    }
    // For step 2, initialize typing logic for codeContainer2 if present and not yet initialized
    if (n === 2 && typeof window.__step2TypingInitialized === "undefined") {
      if (document.getElementById('codeContainer2')) {
        window.__step2TypingInitialized = true;
        initStep2Typing();
      }
    }
    if (n === 3 && typeof window.__step3TypingInitialized === "undefined") {
      if (document.getElementById('codeContainer3')) {
        window.__step3TypingInitialized = true;
        initStep3Typing();
      }
    }
    if (n === 4 && typeof window.__step4TypingInitialized === "undefined") {
      if (document.getElementById('codeContainer4')) {
        window.__step4TypingInitialized = true;
        initStep4Typing();
      }
    }
    if (n === 5 && typeof window.__step5TypingInitialized === "undefined") {
      if (document.getElementById('codeContainer5')) {
        window.__step5TypingInitialized = true;
        initStep5Typing();
      }
    }
    if (n === 6 && typeof window.__step6TypingInitialized === "undefined") {
      if (document.getElementById('codeContainer6')) {
        window.__step6TypingInitialized = true;
        initStep6Typing();
      }
    }
  }
  // Show only step 1 on load
  showStep(1);
</script>
<script>
function runFinalProgram() {
  // Simulasi input yang diisi oleh user dari langkah sebelumnya
  const tanggal = '1 Juni';
  const kota = 'Bandung';
  const waktu = '120'; // Panjang jalur
  const waktuInt = parseInt(waktu);
  const kecepatan = 10;
  const lama = waktuInt / kecepatan;

  // Hasil program
  const hasil =
    "Tanggal: " + tanggal + "\n" +
    "Lokasi: " + kota + "\n" +
    "Lama perjalanan: " + lama + " jam";

  document.getElementById('outputResult').textContent = hasil;
}
</script>
<script>
  // Only initialize typing logic if codeContainer exists (step 1)
  if (document.getElementById('codeContainer')) {
    // Define the code lines for the lesson (edit this array for different lessons)
    const placeholderLines = [
      "tanggal = input('Tanggal:')",
      "kota = input('Lokasi:')",
      "waktu = input('Panjang jalur')",
      "waktu = int(waktu)"
    ];

    // Initialize typed array (keeps user input per line)
    let typed = placeholderLines.map(() => '');
    let lineIndex = 0;
    let charIndex = 0;

    // Syntax highlighting: classify token for a char at index i in line
    function classifyToken(char, line, i) {
      // Keyword: variable name before '='
      if (line.includes('=') && i < line.indexOf('=')) return 'var';
      // Function: input, int, etc.
      if (
        (line.slice(i).startsWith('input') && i + 4 < line.length) ||
        (line.slice(i).startsWith('int') && i + 2 < line.length)
      ) return 'func';
      // String literal: inside single quotes
      let inStr = false;
      for (let j = 0; j <= i; j++) {
        if (line[j] === "'") inStr = !inStr;
      }
      if (inStr) return 'str';
      return '';
    }

    // Render code lines with highlighting and typing feedback
    function renderCode() {
      const codeContainer = document.getElementById('codeContainer');
      codeContainer.innerHTML = '';
      placeholderLines.forEach((line, idx) => {
        const div = document.createElement('div');
        div.className = 'code-line';

        // Line number
        const lineNumber = document.createElement('span');
        lineNumber.className = 'line-number';
        lineNumber.textContent = idx + 1;
        div.appendChild(lineNumber);

        // Code text
        const codeText = document.createElement('span');
        codeText.className = 'code-text';

        for (let i = 0; i < line.length; i++) {
          const span = document.createElement('span');
          const trueChar = line[i];
          const typedChar = typed[idx][i];
          const tokenClass = classifyToken(trueChar, line, i);
          if (typedChar !== undefined) {
            span.textContent = typedChar;
            if (typedChar === trueChar) {
              span.classList.add('correct');
              if (tokenClass) span.classList.add(tokenClass);
            } else {
              span.classList.add('wrong');
            }
          } else {
            span.textContent = trueChar;
            span.style.opacity = 0.3;
          }
          codeText.appendChild(span);
        }
        div.appendChild(codeText);
        codeContainer.appendChild(div);
      });
      let totalTyped = 0, totalCorrect = 0;
      placeholderLines.forEach((line, idx) => {
        for (let i = 0; i < line.length; i++) {
          const trueChar = line[i];
          const typedChar = typed[idx][i];
          if (typedChar !== undefined) totalTyped++;
          if (typedChar === trueChar) totalCorrect++;
        }
      });
      const totalChars = placeholderLines.reduce((sum, line) => sum + line.length, 0);
      const percent = totalChars === 0 ? 0 : Math.floor((totalCorrect / totalChars) * 100);
      document.getElementById('progressBar').style.width = percent + '%';
    }

    // Typing logic: handle keydown events
    document.addEventListener('keydown', (e) => {
      // Only allow typing within bounds
      if (lineIndex < 0 || lineIndex >= placeholderLines.length) return;
      const line = placeholderLines[lineIndex];
      // Printable character
      if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
        if (typed[lineIndex].length < line.length) {
          typed[lineIndex] += e.key;
          charIndex++;
          // Move to next line if finished this line
          if (charIndex >= line.length && lineIndex < placeholderLines.length - 1) {
            lineIndex++;
            charIndex = typed[lineIndex].length;
          }
        }
      } else if (e.key === 'Backspace') {
        if (charIndex > 0) {
          typed[lineIndex] = typed[lineIndex].slice(0, -1);
          charIndex--;
        } else if (lineIndex > 0) {
          // Move to previous line if at start
          lineIndex--;
          charIndex = typed[lineIndex].length;
        }
      }
      renderCode();
    });

    // Initial render
    renderCode();
  }

  // Typing logic for step 2
  function initStep2Typing() {
    // Placeholder lines for step 2
    const placeholderLines2 = [
      "tanggal = input('Tanggal:')",
      "kota = input('Lokasi:')"
    ];
    let typed2 = placeholderLines2.map(() => '');
    let lineIndex2 = 0;
    let charIndex2 = 0;
    // Syntax highlighting: classify token for a char at index i in line
    function classifyToken2(char, line, i) {
      if (line.includes('=') && i < line.indexOf('=')) return 'var';
      if (
        (line.slice(i).startsWith('input') && i + 4 < line.length)
      ) return 'func';
      let inStr = false;
      for (let j = 0; j <= i; j++) {
        if (line[j] === "'") inStr = !inStr;
      }
      if (inStr) return 'str';
      return '';
    }
    function renderCode2() {
      const codeContainer2 = document.getElementById('codeContainer2');
      codeContainer2.innerHTML = '';
      placeholderLines2.forEach((line, idx) => {
        const div = document.createElement('div');
        div.className = 'code-line';
        // Line number
        const lineNumber = document.createElement('span');
        lineNumber.className = 'line-number';
        lineNumber.textContent = idx + 1;
        div.appendChild(lineNumber);
        // Code text
        const codeText = document.createElement('span');
        codeText.className = 'code-text';
        for (let i = 0; i < line.length; i++) {
          const span = document.createElement('span');
          const trueChar = line[i];
          const typedChar = typed2[idx][i];
          const tokenClass = classifyToken2(trueChar, line, i);
          if (typedChar !== undefined) {
            span.textContent = typedChar;
            if (typedChar === trueChar) {
              span.classList.add('correct');
              if (tokenClass) span.classList.add(tokenClass);
            } else {
              span.classList.add('wrong');
            }
          } else {
            span.textContent = trueChar;
            span.style.opacity = 0.3;
          }
          codeText.appendChild(span);
        }
        div.appendChild(codeText);
        codeContainer2.appendChild(div);
      });
      let totalTyped = 0, totalCorrect = 0;
      placeholderLines2.forEach((line, idx) => {
        for (let i = 0; i < line.length; i++) {
          const trueChar = line[i];
          const typedChar = typed2[idx][i];
          if (typedChar !== undefined) totalTyped++;
          if (typedChar === trueChar) totalCorrect++;
        }
      });
      const totalChars = placeholderLines2.reduce((sum, line) => sum + line.length, 0);
      const percent = totalChars === 0 ? 0 : Math.floor((totalCorrect / totalChars) * 100);
      document.getElementById('progressBar').style.width = percent + '%';
    }
    // Typing logic: handle keydown events for step 2
    function keydownStep2(e) {
      // Only allow typing within bounds
      if (lineIndex2 < 0 || lineIndex2 >= placeholderLines2.length) return;
      const line = placeholderLines2[lineIndex2];
      // Printable character
      if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
        if (typed2[lineIndex2].length < line.length) {
          typed2[lineIndex2] += e.key;
          charIndex2++;
          // Move to next line if finished this line
          if (charIndex2 >= line.length && lineIndex2 < placeholderLines2.length - 1) {
            lineIndex2++;
            charIndex2 = typed2[lineIndex2].length;
          }
        }
      } else if (e.key === 'Backspace') {
        if (charIndex2 > 0) {
          typed2[lineIndex2] = typed2[lineIndex2].slice(0, -1);
          charIndex2--;
        } else if (lineIndex2 > 0) {
          lineIndex2--;
          charIndex2 = typed2[lineIndex2].length;
        }
      }
      renderCode2();
    }
    // Attach event listener only when step 2 is visible
    window.__keydownStep2Handler = keydownStep2;
    document.addEventListener('keydown', window.__keydownStep2Handler);
    // Remove the event listener when leaving step 2
    function removeStep2Listener() {
      document.removeEventListener('keydown', window.__keydownStep2Handler);
      window.__step2TypingInitialized = undefined;
    }
    // Listen for step changes to remove listener if not on step 2
    const origShowStep = window.showStep;
    window.showStep = function(n) {
      origShowStep(n);
      if (n !== 2 && typeof window.__keydownStep2Handler !== "undefined") {
        removeStep2Listener();
      }
    };
    // Initial render
    renderCode2();
  }

  // Typing logic for step 3
  function initStep3Typing() {
    const placeholderLines3 = [
      "waktu = input('Panjang jalur')",
      "waktu = int(waktu)"
    ];
    let typed3 = placeholderLines3.map(() => '');
    let lineIndex3 = 0;
    let charIndex3 = 0;
    function classifyToken3(char, line, i) {
      if (line.includes('=') && i < line.indexOf('=')) return 'var';
      if (
        (line.slice(i).startsWith('input') && i + 4 < line.length) ||
        (line.slice(i).startsWith('int') && i + 2 < line.length)
      ) return 'func';
      let inStr = false;
      for (let j = 0; j <= i; j++) {
        if (line[j] === "'") inStr = !inStr;
      }
      if (inStr) return 'str';
      return '';
    }
    function renderCode3() {
      const codeContainer3 = document.getElementById('codeContainer3');
      codeContainer3.innerHTML = '';
      placeholderLines3.forEach((line, idx) => {
        const div = document.createElement('div');
        div.className = 'code-line';
        const lineNumber = document.createElement('span');
        lineNumber.className = 'line-number';
        lineNumber.textContent = idx + 1;
        div.appendChild(lineNumber);
        const codeText = document.createElement('span');
        codeText.className = 'code-text';
        for (let i = 0; i < line.length; i++) {
          const span = document.createElement('span');
          const trueChar = line[i];
          const typedChar = typed3[idx][i];
          const tokenClass = classifyToken3(trueChar, line, i);
          if (typedChar !== undefined) {
            span.textContent = typedChar;
            if (typedChar === trueChar) {
              span.classList.add('correct');
              if (tokenClass) span.classList.add(tokenClass);
            } else {
              span.classList.add('wrong');
            }
          } else {
            span.textContent = trueChar;
            span.style.opacity = 0.3;
          }
          codeText.appendChild(span);
        }
        div.appendChild(codeText);
        codeContainer3.appendChild(div);
      });
      let totalTyped = 0, totalCorrect = 0;
      placeholderLines3.forEach((line, idx) => {
        for (let i = 0; i < line.length; i++) {
          const trueChar = line[i];
          const typedChar = typed3[idx][i];
          if (typedChar !== undefined) totalTyped++;
          if (typedChar === trueChar) totalCorrect++;
        }
      });
      const totalChars = placeholderLines3.reduce((sum, line) => sum + line.length, 0);
      const percent = totalChars === 0 ? 0 : Math.floor((totalCorrect / totalChars) * 100);
      document.getElementById('progressBar').style.width = percent + '%';
    }
    function keydownStep3(e) {
      if (lineIndex3 < 0 || lineIndex3 >= placeholderLines3.length) return;
      const line = placeholderLines3[lineIndex3];
      if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
        if (typed3[lineIndex3].length < line.length) {
          typed3[lineIndex3] += e.key;
          charIndex3++;
          if (charIndex3 >= line.length && lineIndex3 < placeholderLines3.length - 1) {
            lineIndex3++;
            charIndex3 = typed3[lineIndex3].length;
          }
        }
      } else if (e.key === 'Backspace') {
        if (charIndex3 > 0) {
          typed3[lineIndex3] = typed3[lineIndex3].slice(0, -1);
          charIndex3--;
        } else if (lineIndex3 > 0) {
          lineIndex3--;
          charIndex3 = typed3[lineIndex3].length;
        }
      }
      renderCode3();
    }
    window.__keydownStep3Handler = keydownStep3;
    document.addEventListener('keydown', window.__keydownStep3Handler);
    function removeStep3Listener() {
      document.removeEventListener('keydown', window.__keydownStep3Handler);
      window.__step3TypingInitialized = undefined;
    }
    const origShowStep3 = window.showStep;
    window.showStep = function(n) {
      origShowStep3(n);
      if (n !== 3 && typeof window.__keydownStep3Handler !== "undefined") {
        removeStep3Listener();
      }
    };
    renderCode3();
  }

  // Typing logic for step 4
  function initStep4Typing() {
    const placeholderLines4 = [
      "# Contoh: menghitung waktu tempuh",
      "kecepatan = 10",
      "lama = waktu / kecepatan"
    ];
    let typed4 = placeholderLines4.map(() => '');
    let lineIndex4 = 0;
    let charIndex4 = 0;
    function classifyToken4(char, line, i) {
      if (line.trim().startsWith('#')) return 'keyword';
      if (line.includes('=') && i < line.indexOf('=')) return 'var';
      if (line.slice(i).startsWith('waktu') || line.slice(i).startsWith('kecepatan') || line.slice(i).startsWith('lama')) return 'var';
      let inStr = false;
      for (let j = 0; j <= i; j++) {
        if (line[j] === "'") inStr = !inStr;
      }
      if (inStr) return 'str';
      return '';
    }
    function renderCode4() {
      const codeContainer4 = document.getElementById('codeContainer4');
      codeContainer4.innerHTML = '';
      placeholderLines4.forEach((line, idx) => {
        const div = document.createElement('div');
        div.className = 'code-line';
        const lineNumber = document.createElement('span');
        lineNumber.className = 'line-number';
        lineNumber.textContent = idx + 1;
        div.appendChild(lineNumber);
        const codeText = document.createElement('span');
        codeText.className = 'code-text';
        for (let i = 0; i < line.length; i++) {
          const span = document.createElement('span');
          const trueChar = line[i];
          const typedChar = typed4[idx][i];
          const tokenClass = classifyToken4(trueChar, line, i);
          if (typedChar !== undefined) {
            span.textContent = typedChar;
            if (typedChar === trueChar) {
              span.classList.add('correct');
              if (tokenClass) span.classList.add(tokenClass);
            } else {
              span.classList.add('wrong');
            }
          } else {
            span.textContent = trueChar;
            span.style.opacity = 0.3;
          }
          codeText.appendChild(span);
        }
        div.appendChild(codeText);
        codeContainer4.appendChild(div);
      });
      let totalTyped = 0, totalCorrect = 0;
      placeholderLines4.forEach((line, idx) => {
        for (let i = 0; i < line.length; i++) {
          const trueChar = line[i];
          const typedChar = typed4[idx][i];
          if (typedChar !== undefined) totalTyped++;
          if (typedChar === trueChar) totalCorrect++;
        }
      });
      const totalChars = placeholderLines4.reduce((sum, line) => sum + line.length, 0);
      const percent = totalChars === 0 ? 0 : Math.floor((totalCorrect / totalChars) * 100);
      document.getElementById('progressBar').style.width = percent + '%';
    }
    function keydownStep4(e) {
      if (lineIndex4 < 0 || lineIndex4 >= placeholderLines4.length) return;
      const line = placeholderLines4[lineIndex4];
      if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
        if (typed4[lineIndex4].length < line.length) {
          typed4[lineIndex4] += e.key;
          charIndex4++;
          if (charIndex4 >= line.length && lineIndex4 < placeholderLines4.length - 1) {
            lineIndex4++;
            charIndex4 = typed4[lineIndex4].length;
          }
        }
      } else if (e.key === 'Backspace') {
        if (charIndex4 > 0) {
          typed4[lineIndex4] = typed4[lineIndex4].slice(0, -1);
          charIndex4--;
        } else if (lineIndex4 > 0) {
          lineIndex4--;
          charIndex4 = typed4[lineIndex4].length;
        }
      }
      renderCode4();
    }
    window.__keydownStep4Handler = keydownStep4;
    document.addEventListener('keydown', window.__keydownStep4Handler);
    function removeStep4Listener() {
      document.removeEventListener('keydown', window.__keydownStep4Handler);
      window.__step4TypingInitialized = undefined;
    }
    const origShowStep4 = window.showStep;
    window.showStep = function(n) {
      origShowStep4(n);
      if (n !== 4 && typeof window.__keydownStep4Handler !== "undefined") {
        removeStep4Listener();
      }
    };
    renderCode4();
  }

  // Typing logic for step 5
  function initStep5Typing() {
    const placeholderLines5 = [
      "print('Tanggal:', tanggal)",
      "print('Lokasi:', kota)",
      "print('Lama perjalanan:', lama, 'jam')"
    ];
    let typed5 = placeholderLines5.map(() => '');
    let lineIndex5 = 0;
    let charIndex5 = 0;
    function classifyToken5(char, line, i) {
      if (line.startsWith('print') && i < 5) return 'func';
      if (line.includes('tanggal') && line.indexOf('tanggal') <= i && i < line.indexOf('tanggal') + 7) return 'var';
      if (line.includes('kota') && line.indexOf('kota') <= i && i < line.indexOf('kota') + 4) return 'var';
      if (line.includes('lama') && line.indexOf('lama') <= i && i < line.indexOf('lama') + 4) return 'var';
      let inStr = false;
      for (let j = 0; j <= i; j++) {
        if (line[j] === "'") inStr = !inStr;
      }
      if (inStr) return 'str';
      return '';
    }
    function renderCode5() {
      const codeContainer5 = document.getElementById('codeContainer5');
      codeContainer5.innerHTML = '';
      placeholderLines5.forEach((line, idx) => {
        const div = document.createElement('div');
        div.className = 'code-line';
        const lineNumber = document.createElement('span');
        lineNumber.className = 'line-number';
        lineNumber.textContent = idx + 1;
        div.appendChild(lineNumber);
        const codeText = document.createElement('span');
        codeText.className = 'code-text';
        for (let i = 0; i < line.length; i++) {
          const span = document.createElement('span');
          const trueChar = line[i];
          const typedChar = typed5[idx][i];
          const tokenClass = classifyToken5(trueChar, line, i);
          if (typedChar !== undefined) {
            span.textContent = typedChar;
            if (typedChar === trueChar) {
              span.classList.add('correct');
              if (tokenClass) span.classList.add(tokenClass);
            } else {
              span.classList.add('wrong');
            }
          } else {
            span.textContent = trueChar;
            span.style.opacity = 0.3;
          }
          codeText.appendChild(span);
        }
        div.appendChild(codeText);
        codeContainer5.appendChild(div);
      });
      let totalTyped = 0, totalCorrect = 0;
      placeholderLines5.forEach((line, idx) => {
        for (let i = 0; i < line.length; i++) {
          const trueChar = line[i];
          const typedChar = typed5[idx][i];
          if (typedChar !== undefined) totalTyped++;
          if (typedChar === trueChar) totalCorrect++;
        }
      });
      const totalChars = placeholderLines5.reduce((sum, line) => sum + line.length, 0);
      const percent = totalChars === 0 ? 0 : Math.floor((totalCorrect / totalChars) * 100);
      document.getElementById('progressBar').style.width = percent + '%';
    }
    function keydownStep5(e) {
      if (lineIndex5 < 0 || lineIndex5 >= placeholderLines5.length) return;
      const line = placeholderLines5[lineIndex5];
      if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
        if (typed5[lineIndex5].length < line.length) {
          typed5[lineIndex5] += e.key;
          charIndex5++;
          if (charIndex5 >= line.length && lineIndex5 < placeholderLines5.length - 1) {
            lineIndex5++;
            charIndex5 = typed5[lineIndex5].length;
          }
        }
      } else if (e.key === 'Backspace') {
        if (charIndex5 > 0) {
          typed5[lineIndex5] = typed5[lineIndex5].slice(0, -1);
          charIndex5--;
        } else if (lineIndex5 > 0) {
          lineIndex5--;
          charIndex5 = typed5[lineIndex5].length;
        }
      }
      renderCode5();
    }
    window.__keydownStep5Handler = keydownStep5;
    document.addEventListener('keydown', window.__keydownStep5Handler);
    function removeStep5Listener() {
      document.removeEventListener('keydown', window.__keydownStep5Handler);
      window.__step5TypingInitialized = undefined;
    }
    const origShowStep5 = window.showStep;
    window.showStep = function(n) {
      origShowStep5(n);
      if (n !== 5 && typeof window.__keydownStep5Handler !== "undefined") {
        removeStep5Listener();
      }
    };
    renderCode5();
  }

  // Typing logic for step 6
  function initStep6Typing() {
    const placeholderLines6 = [
      "# Jalankan program dan masukkan data yang berbeda untuk melihat hasilnya."
    ];
    let typed6 = placeholderLines6.map(() => '');
    let lineIndex6 = 0;
    let charIndex6 = 0;
    function classifyToken6(char, line, i) {
      if (line.trim().startsWith('#')) return 'keyword';
      let inStr = false;
      for (let j = 0; j <= i; j++) {
        if (line[j] === "'") inStr = !inStr;
      }
      if (inStr) return 'str';
      return '';
    }
    function renderCode6() {
      const codeContainer6 = document.getElementById('codeContainer6');
      codeContainer6.innerHTML = '';
      placeholderLines6.forEach((line, idx) => {
        const div = document.createElement('div');
        div.className = 'code-line';
        const lineNumber = document.createElement('span');
        lineNumber.className = 'line-number';
        lineNumber.textContent = idx + 1;
        div.appendChild(lineNumber);
        const codeText = document.createElement('span');
        codeText.className = 'code-text';
        for (let i = 0; i < line.length; i++) {
          const span = document.createElement('span');
          const trueChar = line[i];
          const typedChar = typed6[idx][i];
          const tokenClass = classifyToken6(trueChar, line, i);
          if (typedChar !== undefined) {
            span.textContent = typedChar;
            if (typedChar === trueChar) {
              span.classList.add('correct');
              if (tokenClass) span.classList.add(tokenClass);
            } else {
              span.classList.add('wrong');
            }
          } else {
            span.textContent = trueChar;
            span.style.opacity = 0.3;
          }
          codeText.appendChild(span);
        }
        div.appendChild(codeText);
        codeContainer6.appendChild(div);
      });
      let totalTyped = 0, totalCorrect = 0;
      placeholderLines6.forEach((line, idx) => {
        for (let i = 0; i < line.length; i++) {
          const trueChar = line[i];
          const typedChar = typed6[idx][i];
          if (typedChar !== undefined) totalTyped++;
          if (typedChar === trueChar) totalCorrect++;
        }
      });
      const totalChars = placeholderLines6.reduce((sum, line) => sum + line.length, 0);
      const percent = totalChars === 0 ? 0 : Math.floor((totalCorrect / totalChars) * 100);
      document.getElementById('progressBar').style.width = percent + '%';
    }
    function keydownStep6(e) {
      if (lineIndex6 < 0 || lineIndex6 >= placeholderLines6.length) return;
      const line = placeholderLines6[lineIndex6];
      if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
        if (typed6[lineIndex6].length < line.length) {
          typed6[lineIndex6] += e.key;
          charIndex6++;
          if (charIndex6 >= line.length && lineIndex6 < placeholderLines6.length - 1) {
            lineIndex6++;
            charIndex6 = typed6[lineIndex6].length;
          }
        }
      } else if (e.key === 'Backspace') {
        if (charIndex6 > 0) {
          typed6[lineIndex6] = typed6[lineIndex6].slice(0, -1);
          charIndex6--;
        } else if (lineIndex6 > 0) {
          lineIndex6--;
          charIndex6 = typed6[lineIndex6].length;
        }
      }
      renderCode6();
    }
    window.__keydownStep6Handler = keydownStep6;
    document.addEventListener('keydown', window.__keydownStep6Handler);
    function removeStep6Listener() {
      document.removeEventListener('keydown', window.__keydownStep6Handler);
      window.__step6TypingInitialized = undefined;
    }
    const origShowStep6 = window.showStep;
    window.showStep = function(n) {
      origShowStep6(n);
      if (n !== 6 && typeof window.__keydownStep6Handler !== "undefined") {
        removeStep6Listener();
      }
    };
    renderCode6();
  }
</script>
</body>
</html>
