<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Craft & Coding L3: Introducing Commands: Move, Turn, Repeat</title>
    
    <!-- FilePond CSS -->
    <link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">
    <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Lesson Navigation */
        .lesson-nav {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .lesson-nav h3 {
            font-family: 'Fredoka One', cursive;
            color: #ff6b6b;
            margin-bottom: 10px;
            text-align: center;
        }

        .lesson-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .lesson-btn {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .lesson-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .lesson-btn.current {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }

        .header {
            text-align: center;
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-family: 'Fredoka One', cursive;
            color: #ff6b6b;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            color: #666;
        }

        .progress-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            font-weight: 600;
            color: #333;
        }

        .slide-navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .slide-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            border: 3px solid white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }

        .slide-dot.active {
            background: #ff6b6b;
            transform: scale(1.2);
        }

        .slide-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            min-height: 400px;
        }

        .slide {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .slide.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide h2 {
            font-family: 'Fredoka One', cursive;
            color: #ff6b6b;
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .slide-content {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #555;
            text-align: center;
        }

        .interactive-box {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
        }

        .quiz-container {
            background: #fff3cd;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #ffeaa7;
        }

        .quiz-question {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: #4ecdc4;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .quiz-option.selected {
            background: #4ecdc4;
            color: white;
            border-color: #4ecdc4;
        }

        /* Command Builder */
        .command-builder {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
        }

        .command-palette {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .command-item {
            background: white;
            border: 2px solid #ddd;
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .command-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .command-move {
            border-color: #2ed573;
            color: #2ed573;
        }

        .command-move:hover {
            background: #2ed573;
            color: white;
        }

        .command-turn {
            border-color: #ffa726;
            color: #ffa726;
        }

        .command-turn:hover {
            background: #ffa726;
            color: white;
        }

        .command-repeat {
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        .command-repeat:hover {
            background: #ff6b6b;
            color: white;
        }

        .command-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .command-workspace {
            background: white;
            border: 2px dashed #4ecdc4;
            border-radius: 15px;
            padding: 20px;
            min-height: 120px;
            margin-bottom: 20px;
        }

        .command-workspace.empty {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-style: italic;
        }

        .command-sequence {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .command-block {
            background: #4ecdc4;
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            font-weight: 600;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .command-block:hover {
            transform: scale(1.05);
        }

        .command-block .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 12px;
            cursor: pointer;
            display: none;
        }

        .command-block:hover .remove-btn {
            display: block;
        }

        .command-block.move {
            background: #2ed573;
        }

        .command-block.turn {
            background: #ffa726;
        }

        .command-block.repeat {
            background: #ff6b6b;
        }

        /* Character Simulator */
        .character-simulator {
            background: #f0f8ff;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #87ceeb;
        }

        .simulator-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 2px;
            background: #ddd;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 20px;
        }

        .grid-cell {
            aspect-ratio: 1;
            background: white;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .character {
            background: #4ecdc4;
            color: white;
            font-weight: bold;
        }

        .simulator-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #2ed573 0%, #1e9258 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .upload-area {
            border: 3px dashed #4ecdc4;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-top: 20px;
            background: #f0fffe;
        }

        .recap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .recap-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .recap-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #4ecdc4;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .audio-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .audio-button:hover {
            transform: scale(1.1);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .slide h2 {
                font-size: 1.5rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .lesson-buttons {
                justify-content: center;
            }
            
            .command-palette {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .simulator-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }

        /* FilePond customization */
        .filepond--root {
            margin-top: 20px;
        }

        .filepond--panel-root {
            background-color: #f0fffe;
            border: 2px dashed #4ecdc4;
        }

        .filepond--drop-label {
            color: #4ecdc4;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Lesson Navigation -->
        <div class="lesson-nav">
            <h3><i class="fas fa-graduation-cap"></i> Pilih Lesson</h3>
            <div class="lesson-buttons">
                <a href="craft-coding-L1.html" class="lesson-btn">L1: Paper Crafts</a>
                <a href="craft-coding-L2.html" class="lesson-btn">L2: Digital Blocks</a>
                <a href="craft-coding-L3.html" class="lesson-btn current">L3: Commands</a>
                <a href="craft-coding-L4.html" class="lesson-btn">L4: QR Codes</a>
                <a href="craft-coding-L5.html" class="lesson-btn">L5: Showcase</a>
            </div>
        </div>

        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-robot"></i> Craft & Coding L3</h1>
            <p>Introducing Commands: Move, Turn, Repeat</p>
        </div>

        <!-- Progress Container -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Progress: 0%</div>
        </div>

        <!-- Slide Navigation -->
        <div class="slide-navigation" id="slideNavigation">
            <div class="slide-dot active" onclick="goToSlide(0)">1</div>
            <div class="slide-dot" onclick="goToSlide(1)">2</div>
            <div class="slide-dot" onclick="goToSlide(2)">3</div>
            <div class="slide-dot" onclick="goToSlide(3)">4</div>
            <div class="slide-dot" onclick="goToSlide(4)">5</div>
            <div class="slide-dot" onclick="goToSlide(5)">6</div>
            <div class="slide-dot" onclick="goToSlide(6)">7</div>
        </div>

        <!-- Slide Container -->
        <div class="slide-container">
            <!-- Slide 1: Introduction -->
            <div class="slide active" id="slide-0">
                <h2><i class="fas fa-gamepad"></i> Hai, Pengendali Karakter Hebat!</h2>
                <div class="slide-content">
                    <p>Pernah ingin menggerakkan karakter seperti di game? Hari ini kita belajar perintah move, turn, dan repeat!</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-question-circle"></i> Mari Berkenalan!</h3>
                        <p>Sebelum memulai, mari kita jawab pertanyaan berikut:</p>
                        <div class="quiz-container">
                            <div class="quiz-question">Pernah bermain game atau menggerakkan karakter?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'intro', 'sering')">
                                    <i class="fas fa-gamepad"></i> Sering main game!
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'intro', 'kadang')">
                                    <i class="fas fa-clock"></i> Kadang-kadang
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'intro', 'belum')">
                                    <i class="fas fa-question"></i> Belum pernah
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 2: Move Command -->
            <div class="slide" id="slide-1">
                <h2><i class="fas fa-walking"></i> Apa Itu Perintah Move?</h2>
                <div class="slide-content">
                    <p>Perintah move membuat karakter kita berjalan ke depan.</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #1</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Apa fungsi perintah move?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q1', 'a')">
                                    A. Membuat karakter berjalan ke depan
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q1', 'b')">
                                    B. Membuat karakter berputar
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q1', 'c')">
                                    C. Membuat karakter menghilang
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 3: Turn Command -->
            <div class="slide" id="slide-2">
                <h2><i class="fas fa-sync-alt"></i> Apa Itu Perintah Turn?</h2>
                <div class="slide-content">
                    <p>Perintah turn membuat karakter kita berputar ke arah yang diinginkan.</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #2</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Apa fungsi perintah turn?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q2', 'a')">
                                    A. Membuat karakter berjalan mundur
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q2', 'b')">
                                    B. Membuat karakter berputar ke arah yang diinginkan
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q2', 'c')">
                                    C. Membuat karakter melompat
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 4: Repeat Command -->
            <div class="slide" id="slide-3">
                <h2><i class="fas fa-redo"></i> Apa Itu Perintah Repeat?</h2>
                <div class="slide-content">
                    <p>Perintah repeat membuat karakter mengulangi gerakan berkali-kali.</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #3</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Apa fungsi perintah repeat?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q3', 'a')">
                                    A. Membuat karakter berhenti
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q3', 'b')">
                                    B. Membuat karakter mengulangi gerakan berkali-kali
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q3', 'c')">
                                    C. Membuat karakter berubah warna
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 5: Build Commands -->
            <div class="slide" id="slide-4">
                <h2><i class="fas fa-code"></i> Buat Gerakanmu!</h2>
                <div class="slide-content">
                    <p>Susun perintah move, turn, dan repeat di aplikasi dan lihat karakter bergerak!</p>
                    <div class="command-builder">
                        <h3><i class="fas fa-magic"></i> Pembuat Perintah</h3>
                        <p>Klik perintah di bawah untuk membuat urutan gerakan:</p>
                        
                        <div class="command-palette">
                            <div class="command-item command-move" onclick="addCommand('move', 'Maju')">
                                <div class="command-icon">
                                    <i class="fas fa-arrow-up"></i>
                                </div>
                                <div>Move</div>
                            </div>
                            <div class="command-item command-turn" onclick="addCommand('turn', 'Putar')">
                                <div class="command-icon">
                                    <i class="fas fa-sync-alt"></i>
                                </div>
                                <div>Turn</div>
                            </div>
                            <div class="command-item command-repeat" onclick="addCommand('repeat', 'Ulang')">
                                <div class="command-icon">
                                    <i class="fas fa-redo"></i>
                                </div>
                                <div>Repeat</div>
                            </div>
                        </div>

                        <div class="command-workspace empty" id="commandWorkspace">
                            Klik perintah di atas untuk membuat urutan gerakan!
                        </div>

                        <div style="text-align: center;">
                            <button class="btn btn-warning" onclick="clearCommands()">
                                <i class="fas fa-trash"></i> Hapus Semua
                            </button>
                            <button class="btn btn-success" onclick="runCommands()">
                                <i class="fas fa-play"></i> Jalankan
                            </button>
                        </div>
                    </div>
                    
                    <div class="character-simulator">
                        <h3><i class="fas fa-robot"></i> Simulator Karakter</h3>
                        <div class="simulator-grid" id="simulatorGrid"></div>
                        <div class="simulator-controls">
                            <button class="btn btn-primary" onclick="resetCharacter()">
                                <i class="fas fa-home"></i> Reset Posisi
                            </button>
                        </div>
                    </div>
                    
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #4</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Sebutkan dua contoh gerakan yang bisa dibuat dengan move dan turn.</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q4', 'a')">
                                    A. Berjalan lurus dan berputar kanan
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q4', 'b')">
                                    B. Melompat dan terbang
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q4', 'c')">
                                    C. Menghilang dan muncul
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 6: Show Your Work -->
            <div class="slide" id="slide-5">
                <h2><i class="fas fa-camera"></i> Hasil Karyamu!</h2>
                <div class="slide-content">
                    <p>Tunjukkan gerakan karakter yang sudah kamu buat ke guru atau orang tua.</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-upload"></i> Upload Foto/Video Hasil Karya</h3>
                        <p>Ambil foto atau video gerakan karaktermu dan upload di sini:</p>
                        <div class="upload-area">
                            <input type="file" id="photoUpload" accept="image/*,video/*" style="display: none;">
                            <button class="btn btn-primary" onclick="document.getElementById('photoUpload').click()">
                                <i class="fas fa-camera"></i> Pilih Foto/Video
                            </button>
                            <p>atau drag & drop file ke sini</p>
                            <div id="photoPreview"></div>
                        </div>
                    </div>
                    
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #5</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Kenapa perintah repeat membuat coding lebih mudah?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q5', 'a')">
                                    A. Karena tidak perlu menulis perintah yang sama berkali-kali
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q5', 'b')">
                                    B. Karena membuat karakter bergerak lebih cepat
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q5', 'c')">
                                    C. Karena membuat kode lebih panjang
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 7: Congratulations -->
            <div class="slide" id="slide-6">
                <h2><i class="fas fa-trophy"></i> Hebat!</h2>
                <div class="slide-content">
                    <p>Hari ini kamu belajar perintah dasar coding. Siap belajar perintah lebih seru di lesson berikutnya?</p>
                    <div class="recap-grid">
                        <div class="recap-card">
                            <div class="recap-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h4>Soal Teori</h4>
                            <p id="quizScore">0/5 Terjawab</p>
                        </div>
                        <div class="recap-card">
                            <div class="recap-icon">
                                <i class="fas fa-code"></i>
                            </div>
                            <h4>Perintah Karakter</h4>
                            <p id="commandScore">Belum dibuat</p>
                        </div>
                        <div class="recap-card">
                            <div class="recap-icon">
                                <i class="fas fa-camera"></i>
                            </div>
                            <h4>Foto/Video Hasil</h4>
                            <p id="photoScore">Belum diupload</p>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <a href="craft-coding-L4.html" class="btn btn-success">
                            <i class="fas fa-arrow-right"></i> Lanjut ke L4: QR Codes
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="navigation-buttons">
            <button class="btn" onclick="previousSlide()" id="prevBtn">
                <i class="fas fa-arrow-left"></i> Sebelumnya
            </button>
            <button class="btn btn-primary" onclick="nextSlide()" id="nextBtn">
                Selanjutnya <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- Audio Button -->
    <button class="audio-button" onclick="playAudio()" id="audioBtn">
        <i class="fas fa-volume-up"></i>
    </button>

    <!-- FilePond JS -->
    <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
    <script src="https://unpkg.com/filepond/dist/filepond.js"></script>

    <script>
        // App State
        let currentSlide = 0;
        let totalSlides = 7;
        let quizAnswers = {};
        let commandSequence = [];
        let uploadedMedia = null;
        let characterPos = { x: 0, y: 0, direction: 0 }; // 0=up, 1=right, 2=down, 3=left

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            updateSlideNavigation();
            updateProgress();
            setupFileUpload();
            setupDragAndDrop();
            initializeSimulator();
        });

        // Slide Navigation
        function goToSlide(slideIndex) {
            document.querySelectorAll('.slide').forEach(slide => slide.classList.remove('active'));
            document.querySelectorAll('.slide-dot').forEach(dot => dot.classList.remove('active'));
            
            document.getElementById(`slide-${slideIndex}`).classList.add('active');
            document.querySelectorAll('.slide-dot')[slideIndex].classList.add('active');
            
            currentSlide = slideIndex;
            updateSlideNavigation();
            saveProgress();
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                goToSlide(currentSlide + 1);
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                goToSlide(currentSlide - 1);
            }
        }

        function updateSlideNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = currentSlide === 0 ? 'none' : 'inline-block';
            nextBtn.innerHTML = currentSlide === totalSlides - 1 ? 
                '<i class="fas fa-check"></i> Selesai' : 
                'Selanjutnya <i class="fas fa-arrow-right"></i>';
        }

        // Quiz System
        function selectQuizOption(element, questionId, answer) {
            // Remove selected class from siblings
            element.parentNode.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Save answer
            quizAnswers[questionId] = answer;
            
            // Show success message
            showSuccessMessage(element.parentNode.parentNode, 'Jawaban tersimpan!');
            
            // Update progress
            updateProgress();
            saveProgress();
        }

        // Command System
        function addCommand(type, label) {
            const workspace = document.getElementById('commandWorkspace');
            
            // Remove empty message
            if (workspace.classList.contains('empty')) {
                workspace.classList.remove('empty');
                workspace.innerHTML = '<div class="command-sequence" id="commandSequence"></div>';
            }
            
            // Create new command block
            const commandBlock = document.createElement('div');
            commandBlock.className = `command-block ${type}`;
            commandBlock.innerHTML = `
                ${label}
                <button class="remove-btn" onclick="removeCommand(this)">×</button>
            `;
            
            document.getElementById('commandSequence').appendChild(commandBlock);
            commandSequence.push({type, label});
            
            // Update progress
            updateProgress();
            saveProgress();
        }

        function removeCommand(button) {
            const block = button.parentNode;
            const index = Array.from(block.parentNode.children).indexOf(block);
            
            block.remove();
            commandSequence.splice(index, 1);
            
            // Show empty message if no commands
            const workspace = document.getElementById('commandWorkspace');
            if (workspace.querySelector('.command-sequence').children.length === 0) {
                workspace.classList.add('empty');
                workspace.innerHTML = 'Klik perintah di atas untuk membuat urutan gerakan!';
            }
            
            updateProgress();
            saveProgress();
        }

        function clearCommands() {
            if (confirm('Hapus semua perintah?')) {
                document.getElementById('commandWorkspace').innerHTML = 'Klik perintah di atas untuk membuat urutan gerakan!';
                document.getElementById('commandWorkspace').classList.add('empty');
                commandSequence = [];
                updateProgress();
                saveProgress();
            }
        }

        function runCommands() {
            if (commandSequence.length === 0) {
                alert('Buat urutan perintah terlebih dahulu!');
                return;
            }
            
            // Reset character position
            resetCharacter();
            
            // Execute commands with animation
            executeCommandSequence(0);
        }

        function executeCommandSequence(index) {
            if (index >= commandSequence.length) {
                // Show completion message
                const workspace = document.getElementById('commandWorkspace');
                showSuccessMessage(workspace.parentNode, 'Perintah berhasil dijalankan!');
                return;
            }
            
            const command = commandSequence[index];
            
            setTimeout(() => {
                switch(command.type) {
                    case 'move':
                        moveCharacter();
                        break;
                    case 'turn':
                        turnCharacter();
                        break;
                    case 'repeat':
                        // Simple repeat: repeat the last command
                        if (index > 0) {
                            const lastCommand = commandSequence[index - 1];
                            if (lastCommand.type === 'move') {
                                moveCharacter();
                            } else if (lastCommand.type === 'turn') {
                                turnCharacter();
                            }
                        }
                        break;
                }
                
                executeCommandSequence(index + 1);
            }, 1000);
        }

        // Character Simulator
        function initializeSimulator() {
            const grid = document.getElementById('simulatorGrid');
            grid.innerHTML = '';
            
            // Create 8x8 grid
            for (let i = 0; i < 64; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell';
                cell.id = `cell-${i}`;
                grid.appendChild(cell);
            }
            
            // Place character at starting position
            updateCharacterDisplay();
        }

        function moveCharacter() {
            const gridSize = 8;
            let newX = characterPos.x;
            let newY = characterPos.y;
            
            // Calculate new position based on direction
            switch(characterPos.direction) {
                case 0: // up
                    newY = Math.max(0, newY - 1);
                    break;
                case 1: // right
                    newX = Math.min(gridSize - 1, newX + 1);
                    break;
                case 2: // down
                    newY = Math.min(gridSize - 1, newY + 1);
                    break;
                case 3: // left
                    newX = Math.max(0, newX - 1);
                    break;
            }
            
            characterPos.x = newX;
            characterPos.y = newY;
            updateCharacterDisplay();
        }

        function turnCharacter() {
            characterPos.direction = (characterPos.direction + 1) % 4;
            updateCharacterDisplay();
        }

        function resetCharacter() {
            characterPos = { x: 0, y: 0, direction: 0 };
            updateCharacterDisplay();
        }

        function updateCharacterDisplay() {
            // Clear all cells
            document.querySelectorAll('.grid-cell').forEach(cell => {
                cell.classList.remove('character');
                cell.textContent = '';
            });
            
            // Place character
            const cellIndex = characterPos.y * 8 + characterPos.x;
            const cell = document.getElementById(`cell-${cellIndex}`);
            cell.classList.add('character');
            
            // Set character direction arrow
            const arrows = ['↑', '→', '↓', '←'];
            cell.textContent = arrows[characterPos.direction];
        }

        // File Upload System
        function setupFileUpload() {
            const photoUpload = document.getElementById('photoUpload');
            const photoPreview = document.getElementById('photoPreview');
            
            photoUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    handleMediaUpload(file);
                }
            });
        }

        function setupDragAndDrop() {
            const uploadArea = document.querySelector('.upload-area');
            
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#44a08d';
                uploadArea.style.backgroundColor = '#e8f5f3';
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#4ecdc4';
                uploadArea.style.backgroundColor = '#f0fffe';
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#4ecdc4';
                uploadArea.style.backgroundColor = '#f0fffe';
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleMediaUpload(files[0]);
                }
            });
        }

        function handleMediaUpload(file) {
            if (!file.type.startsWith('image/') && !file.type.startsWith('video/')) {
                alert('Hanya file gambar atau video yang diperbolehkan!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById('photoPreview');
                const mediaElement = file.type.startsWith('image/') ? 
                    `<img src="${e.target.result}" alt="Foto hasil karya" class="photo-preview">` :
                    `<video src="${e.target.result}" controls class="photo-preview"></video>`;
                
                preview.innerHTML = `
                    ${mediaElement}
                    <div class="success-message">
                        <i class="fas fa-check"></i> ${file.type.startsWith('image/') ? 'Foto' : 'Video'} berhasil diupload!
                    </div>
                `;
                
                uploadedMedia = {
                    data: e.target.result,
                    name: file.name,
                    type: file.type,
                    timestamp: new Date().toISOString()
                };
                
                updateProgress();
                saveProgress();
            };
            
            reader.readAsDataURL(file);
        }

        // Progress System
        function updateProgress() {
            const totalTasks = 8; // 5 quiz + 1 commands + 1 media + 1 completion
            let completedTasks = 0;
            
            // Count quiz answers
            const quizCount = Object.keys(quizAnswers).length;
            completedTasks += quizCount;
            
            // Count command creation
            if (commandSequence.length > 0) {
                completedTasks += 1;
            }
            
            // Count media upload
            if (uploadedMedia) {
                completedTasks += 1;
            }
            
            // Count completion
            if (currentSlide === totalSlides - 1) {
                completedTasks += 1;
            }
            
            const progressPercentage = Math.round((completedTasks / totalTasks) * 100);
            
            document.getElementById('progressFill').style.width = progressPercentage + '%';
            document.getElementById('progressText').textContent = `Progress: ${progressPercentage}%`;
            
            // Update recap
            updateRecap();
        }

        function updateRecap() {
            const quizCount = Object.keys(quizAnswers).length;
            document.getElementById('quizScore').textContent = `${quizCount}/5 Terjawab`;
            
            const commandStatus = commandSequence.length > 0 ? 
                `${commandSequence.length} perintah dibuat` : 'Belum dibuat';
            document.getElementById('commandScore').textContent = commandStatus;
            
            const mediaStatus = uploadedMedia ? 'Sudah diupload' : 'Belum diupload';
            document.getElementById('photoScore').textContent = mediaStatus;
        }

        // Audio System
        function playAudio() {
            const slideTexts = [
                'Hai, Pengendali Karakter Hebat! Pernah ingin menggerakkan karakter seperti di game? Hari ini kita belajar perintah move, turn, dan repeat!',
                'Perintah move membuat karakter kita berjalan ke depan.',
                'Perintah turn membuat karakter kita berputar ke arah yang diinginkan.',
                'Perintah repeat membuat karakter mengulangi gerakan berkali-kali.',
                'Susun perintah move, turn, dan repeat di aplikasi dan lihat karakter bergerak!',
                'Tunjukkan gerakan karakter yang sudah kamu buat ke guru atau orang tua.',
                'Hari ini kamu belajar perintah dasar coding. Siap belajar perintah lebih seru di lesson berikutnya?'
            ];
            
            alert(`Audio: ${slideTexts[currentSlide]}`);
        }

        // Storage System
        function saveProgress() {
            const progressData = {
                currentSlide,
                quizAnswers,
                commandSequence,
                uploadedMedia,
                characterPos,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('craft-coding-l3-progress', JSON.stringify(progressData));
        }

        function loadProgress() {
            const savedData = localStorage.getItem('craft-coding-l3-progress');
            if (savedData) {
                const progressData = JSON.parse(savedData);
                currentSlide = progressData.currentSlide || 0;
                quizAnswers = progressData.quizAnswers || {};
                commandSequence = progressData.commandSequence || [];
                uploadedMedia = progressData.uploadedMedia || null;
                characterPos = progressData.characterPos || { x: 0, y: 0, direction: 0 };
                
                // Restore UI state
                goToSlide(currentSlide);
                restoreQuizAnswers();
                restoreCommands();
                restoreMedia();
            }
        }

        function restoreQuizAnswers() {
            Object.keys(quizAnswers).forEach(questionId => {
                const answer = quizAnswers[questionId];
                const options = document.querySelectorAll(`[onclick*="${questionId}"]`);
                options.forEach(option => {
                    if (option.getAttribute('onclick').includes(`'${answer}'`)) {
                        option.classList.add('selected');
                    }
                });
            });
        }

        function restoreCommands() {
            if (commandSequence.length > 0) {
                const workspace = document.getElementById('commandWorkspace');
                workspace.classList.remove('empty');
                workspace.innerHTML = '<div class="command-sequence" id="commandSequence"></div>';
                
                commandSequence.forEach(command => {
                    const commandBlock = document.createElement('div');
                    commandBlock.className = `command-block ${command.type}`;
                    commandBlock.innerHTML = `
                        ${command.label}
                        <button class="remove-btn" onclick="removeCommand(this)">×</button>
                    `;
                    document.getElementById('commandSequence').appendChild(commandBlock);
                });
            }
        }

        function restoreMedia() {
            if (uploadedMedia) {
                const preview = document.getElementById('photoPreview');
                const mediaElement = uploadedMedia.type.startsWith('image/') ? 
                    `<img src="${uploadedMedia.data}" alt="Foto hasil karya" class="photo-preview">` :
                    `<video src="${uploadedMedia.data}" controls class="photo-preview"></video>`;
                
                preview.innerHTML = `
                    ${mediaElement}
                    <div class="success-message">
                        <i class="fas fa-check"></i> ${uploadedMedia.type.startsWith('image/') ? 'Foto' : 'Video'} berhasil diupload!
                    </div>
                `;
            }
        }

        // Utility Functions
        function showSuccessMessage(container, message) {
            const existingMessage = container.querySelector('.success-message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'success-message';
            messageDiv.innerHTML = `<i class="fas fa-check"></i> ${message}`;
            container.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                previousSlide();
            } else if (e.key === 'ArrowRight') {
                nextSlide();
            }
        });
    </script>
</body>
</html>