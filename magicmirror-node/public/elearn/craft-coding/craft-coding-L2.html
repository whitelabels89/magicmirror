<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Craft & Coding L2: Building Patterns with Digital Blocks</title>
    
    <!-- FilePond CSS -->
    <link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">
    <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Lesson Navigation */
        .lesson-nav {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .lesson-nav h3 {
            font-family: 'Fredoka One', cursive;
            color: #ff6b6b;
            margin-bottom: 10px;
            text-align: center;
        }

        .lesson-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .lesson-btn {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .lesson-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .lesson-btn.current {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }

        .header {
            text-align: center;
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-family: 'Fredoka One', cursive;
            color: #ff6b6b;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            color: #666;
        }

        .progress-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            font-weight: 600;
            color: #333;
        }

        .slide-navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .slide-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            border: 3px solid white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }

        .slide-dot.active {
            background: #ff6b6b;
            transform: scale(1.2);
        }

        .slide-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            min-height: 400px;
        }

        .slide {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .slide.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide h2 {
            font-family: 'Fredoka One', cursive;
            color: #ff6b6b;
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .slide-content {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #555;
            text-align: center;
        }

        .interactive-box {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
        }

        .quiz-container {
            background: #fff3cd;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #ffeaa7;
        }

        .quiz-question {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: #4ecdc4;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .quiz-option.selected {
            background: #4ecdc4;
            color: white;
            border-color: #4ecdc4;
        }

        /* Digital Block Builder */
        .block-builder {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
        }

        .block-palette {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .block-item {
            width: 80px;
            height: 80px;
            border-radius: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            transition: all 0.3s ease;
            user-select: none;
        }

        .block-item:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .block-red { background: #ff6b6b; }
        .block-blue { background: #4ecdc4; }
        .block-green { background: #2ed573; }
        .block-yellow { background: #ffa726; }
        .block-purple { background: #764ba2; }
        .block-orange { background: #ff7675; }

        .pattern-workspace {
            background: white;
            border: 2px dashed #4ecdc4;
            border-radius: 15px;
            padding: 20px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .pattern-workspace.empty {
            color: #999;
            font-style: italic;
        }

        .pattern-block {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .pattern-block:hover {
            transform: scale(1.1);
        }

        .pattern-block .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 12px;
            cursor: pointer;
            display: none;
        }

        .pattern-block:hover .remove-btn {
            display: block;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #2ed573 0%, #1e9258 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .upload-area {
            border: 3px dashed #4ecdc4;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-top: 20px;
            background: #f0fffe;
        }

        .recap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .recap-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .recap-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #4ecdc4;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .audio-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .audio-button:hover {
            transform: scale(1.1);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .slide h2 {
                font-size: 1.5rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .lesson-buttons {
                justify-content: center;
            }
            
            .block-palette {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* FilePond customization */
        .filepond--root {
            margin-top: 20px;
        }

        .filepond--panel-root {
            background-color: #f0fffe;
            border: 2px dashed #4ecdc4;
        }

        .filepond--drop-label {
            color: #4ecdc4;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Lesson Navigation -->
        <div class="lesson-nav">
            <h3><i class="fas fa-graduation-cap"></i> Pilih Lesson</h3>
            <div class="lesson-buttons">
                <a href="craft-coding-L1.html" class="lesson-btn">L1: Paper Crafts</a>
                <a href="craft-coding-L2.html" class="lesson-btn current">L2: Digital Blocks</a>
                <a href="craft-coding-L3.html" class="lesson-btn">L3: Commands</a>
                <a href="craft-coding-L4.html" class="lesson-btn">L4: QR Codes</a>
                <a href="craft-coding-L5.html" class="lesson-btn">L5: Showcase</a>
            </div>
        </div>

        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-cubes"></i> Craft & Coding L2</h1>
            <p>Building Patterns with Digital Blocks</p>
        </div>

        <!-- Progress Container -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Progress: 0%</div>
        </div>

        <!-- Slide Navigation -->
        <div class="slide-navigation" id="slideNavigation">
            <div class="slide-dot active" onclick="goToSlide(0)">1</div>
            <div class="slide-dot" onclick="goToSlide(1)">2</div>
            <div class="slide-dot" onclick="goToSlide(2)">3</div>
            <div class="slide-dot" onclick="goToSlide(3)">4</div>
            <div class="slide-dot" onclick="goToSlide(4)">5</div>
            <div class="slide-dot" onclick="goToSlide(5)">6</div>
        </div>

        <!-- Slide Container -->
        <div class="slide-container">
            <!-- Slide 1: Introduction -->
            <div class="slide active" id="slide-0">
                <h2><i class="fas fa-cubes"></i> Hai, Pembuat Pola Digital Hebat!</h2>
                <div class="slide-content">
                    <p>Pernah main lego atau balok susun? Hari ini kita akan membuat pola keren dengan blok digital!</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-question-circle"></i> Mari Berkenalan!</h3>
                        <p>Sebelum memulai, mari kita jawab pertanyaan berikut:</p>
                        <div class="quiz-container">
                            <div class="quiz-question">Pernah bermain dengan balok susun atau lego?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'intro', 'sering')">
                                    <i class="fas fa-heart"></i> Sering banget!
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'intro', 'kadang')">
                                    <i class="fas fa-clock"></i> Kadang-kadang
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'intro', 'belum')">
                                    <i class="fas fa-question"></i> Belum pernah
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 2: What are Digital Blocks -->
            <div class="slide" id="slide-1">
                <h2><i class="fas fa-cube"></i> Apa Itu Blok Digital?</h2>
                <div class="slide-content">
                    <p>Blok digital adalah balok warna atau perintah yang bisa disusun di tablet untuk membuat pola atau gerakan.</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #1</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Apa itu blok digital?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q1', 'a')">
                                    A. Balok nyata yang bisa dipegang
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q1', 'b')">
                                    B. Balok warna di layar yang bisa disusun untuk membuat pola
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q1', 'c')">
                                    C. Gambar yang tidak bisa dipindah-pindah
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 3: Choose Your Blocks -->
            <div class="slide" id="slide-2">
                <h2><i class="fas fa-palette"></i> Pilih Blokmu</h2>
                <div class="slide-content">
                    <p>Pilih blok warna atau perintah di aplikasi seperti Scratch Jr.</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #2</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Sebutkan dua manfaat belajar membuat pola dengan blok digital.</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q2', 'a')">
                                    A. Melatih kreativitas dan logika berpikir
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q2', 'b')">
                                    B. Membuat mata lelah dan bosan
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q2', 'c')">
                                    C. Menghabiskan waktu tanpa manfaat
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 4: Build Your Pattern -->
            <div class="slide" id="slide-3">
                <h2><i class="fas fa-hammer"></i> Susun Polamu!</h2>
                <div class="slide-content">
                    <p>Seret blok-blok itu ke layar dan susun pola unikmu sendiri.</p>
                    <div class="block-builder">
                        <h3><i class="fas fa-cubes"></i> Pembuat Pola Digital</h3>
                        <p>Pilih blok warna di bawah, lalu klik untuk menambahkan ke pola:</p>
                        
                        <div class="block-palette">
                            <div class="block-item block-red" onclick="addBlock('red', '游댮')">游댮</div>
                            <div class="block-item block-blue" onclick="addBlock('blue', '游댯')">游댯</div>
                            <div class="block-item block-green" onclick="addBlock('green', '游릭')">游릭</div>
                            <div class="block-item block-yellow" onclick="addBlock('yellow', '游리')">游리</div>
                            <div class="block-item block-purple" onclick="addBlock('purple', '游릮')">游릮</div>
                            <div class="block-item block-orange" onclick="addBlock('orange', '游')">游</div>
                        </div>

                        <div class="pattern-workspace empty" id="patternWorkspace">
                            Klik blok warna di atas untuk memulai membuat pola!
                        </div>

                        <div style="text-align: center;">
                            <button class="btn btn-warning" onclick="clearPattern()">
                                <i class="fas fa-trash"></i> Hapus Semua
                            </button>
                            <button class="btn btn-success" onclick="savePattern()">
                                <i class="fas fa-save"></i> Simpan Pola
                            </button>
                        </div>
                    </div>
                    
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #3</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Kenapa kita harus menyusun blok dengan rapi?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q3', 'a')">
                                    A. Agar pola terlihat bagus dan mudah dipahami
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q3', 'b')">
                                    B. Tidak perlu rapi, yang penting jadi
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q3', 'c')">
                                    C. Supaya guru senang saja
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 5: Show Your Work -->
            <div class="slide" id="slide-4">
                <h2><i class="fas fa-camera"></i> Hasil Karyamu!</h2>
                <div class="slide-content">
                    <p>Foto pola digital yang sudah kamu buat dan tunjukkan ke guru atau orang tua.</p>
                    <div class="interactive-box">
                        <h3><i class="fas fa-upload"></i> Upload Foto Hasil Karya</h3>
                        <p>Ambil foto pola digitalmu dan upload di sini:</p>
                        <div class="upload-area">
                            <input type="file" id="photoUpload" accept="image/*" style="display: none;">
                            <button class="btn btn-primary" onclick="document.getElementById('photoUpload').click()">
                                <i class="fas fa-camera"></i> Pilih Foto
                            </button>
                            <p>atau drag & drop foto ke sini</p>
                            <div id="photoPreview"></div>
                        </div>
                    </div>
                    
                    <div class="interactive-box">
                        <h3><i class="fas fa="brain"></i> Soal Teori #4</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Apa aplikasi yang bisa digunakan untuk membuat pola digital?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q4', 'a')">
                                    A. Scratch Jr atau aplikasi blok digital lainnya
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q4', 'b')">
                                    B. Kalkulator
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q4', 'c')">
                                    C. Aplikasi musik
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 6: Congratulations -->
            <div class="slide" id="slide-5">
                <h2><i class="fas fa-trophy"></i> Hebat!</h2>
                <div class="slide-content">
                    <p>Hari ini kamu belajar membuat pola dari blok digital. Siap buat pola lebih seru di lesson berikutnya?</p>
                    <div class="recap-grid">
                        <div class="recap-card">
                            <div class="recap-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h4>Soal Teori</h4>
                            <p id="quizScore">0/5 Terjawab</p>
                        </div>
                        <div class="recap-card">
                            <div class="recap-icon">
                                <i class="fas fa-cubes"></i>
                            </div>
                            <h4>Pola Digital</h4>
                            <p id="patternScore">Belum dibuat</p>
                        </div>
                        <div class="recap-card">
                            <div class="recap-icon">
                                <i class="fas fa-camera"></i>
                            </div>
                            <h4>Foto Hasil</h4>
                            <p id="photoScore">Belum diupload</p>
                        </div>
                    </div>
                    
                    <div class="interactive-box">
                        <h3><i class="fas fa-brain"></i> Soal Teori #5</h3>
                        <div class="quiz-container">
                            <div class="quiz-question">Bagaimana cara memulai membuat pola di tablet?</div>
                            <div class="quiz-options">
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q5', 'a')">
                                    A. Buka aplikasi, pilih blok, lalu seret ke layar
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q5', 'b')">
                                    B. Langsung menggambar dengan pensil di layar
                                </div>
                                <div class="quiz-option" onclick="selectQuizOption(this, 'q5', 'c')">
                                    C. Mengetik dengan keyboard
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <a href="craft-coding-L3.html" class="btn btn-success">
                            <i class="fas fa-arrow-right"></i> Lanjut ke L3: Commands
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="navigation-buttons">
            <button class="btn" onclick="previousSlide()" id="prevBtn">
                <i class="fas fa-arrow-left"></i> Sebelumnya
            </button>
            <button class="btn btn-primary" onclick="nextSlide()" id="nextBtn">
                Selanjutnya <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- Audio Button -->
    <button class="audio-button" onclick="playAudio()" id="audioBtn">
        <i class="fas fa-volume-up"></i>
    </button>

    <!-- FilePond JS -->
    <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
    <script src="https://unpkg.com/filepond/dist/filepond.js"></script>

    <script>
        // App State
        let currentSlide = 0;
        let totalSlides = 6;
        let quizAnswers = {};
        let digitalPattern = [];
        let uploadedPhoto = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            updateSlideNavigation();
            updateProgress();
            setupFileUpload();
            setupDragAndDrop();
        });

        // Slide Navigation
        function goToSlide(slideIndex) {
            document.querySelectorAll('.slide').forEach(slide => slide.classList.remove('active'));
            document.querySelectorAll('.slide-dot').forEach(dot => dot.classList.remove('active'));
            
            document.getElementById(`slide-${slideIndex}`).classList.add('active');
            document.querySelectorAll('.slide-dot')[slideIndex].classList.add('active');
            
            currentSlide = slideIndex;
            updateSlideNavigation();
            saveProgress();
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                goToSlide(currentSlide + 1);
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                goToSlide(currentSlide - 1);
            }
        }

        function updateSlideNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = currentSlide === 0 ? 'none' : 'inline-block';
            nextBtn.innerHTML = currentSlide === totalSlides - 1 ? 
                '<i class="fas fa-check"></i> Selesai' : 
                'Selanjutnya <i class="fas fa-arrow-right"></i>';
        }

        // Quiz System
        function selectQuizOption(element, questionId, answer) {
            // Remove selected class from siblings
            element.parentNode.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Save answer
            quizAnswers[questionId] = answer;
            
            // Show success message
            showSuccessMessage(element.parentNode.parentNode, 'Jawaban tersimpan!');
            
            // Update progress
            updateProgress();
            saveProgress();
        }

        // Digital Pattern Builder
        function addBlock(color, emoji) {
            const workspace = document.getElementById('patternWorkspace');
            
            // Remove empty message
            if (workspace.classList.contains('empty')) {
                workspace.classList.remove('empty');
                workspace.innerHTML = '';
            }
            
            // Create new block
            const block = document.createElement('div');
            block.className = `pattern-block block-${color}`;
            block.innerHTML = `
                ${emoji}
                <button class="remove-btn" onclick="removeBlock(this)">칑</button>
            `;
            
            workspace.appendChild(block);
            digitalPattern.push({color, emoji});
            
            // Update progress
            updateProgress();
            saveProgress();
        }

        function removeBlock(button) {
            const block = button.parentNode;
            const index = Array.from(block.parentNode.children).indexOf(block);
            
            block.remove();
            digitalPattern.splice(index, 1);
            
            // Show empty message if no blocks
            const workspace = document.getElementById('patternWorkspace');
            if (workspace.children.length === 0) {
                workspace.classList.add('empty');
                workspace.innerHTML = 'Klik blok warna di atas untuk memulai membuat pola!';
            }
            
            updateProgress();
            saveProgress();
        }

        function clearPattern() {
            if (confirm('Hapus semua blok dalam pola?')) {
                document.getElementById('patternWorkspace').innerHTML = 'Klik blok warna di atas untuk memulai membuat pola!';
                document.getElementById('patternWorkspace').classList.add('empty');
                digitalPattern = [];
                updateProgress();
                saveProgress();
            }
        }

        function savePattern() {
            if (digitalPattern.length === 0) {
                alert('Buat pola terlebih dahulu!');
                return;
            }
            
            const patternData = {
                pattern: digitalPattern,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('craft-coding-l2-pattern', JSON.stringify(patternData));
            
            const workspace = document.getElementById('patternWorkspace');
            showSuccessMessage(workspace.parentNode, 'Pola berhasil disimpan!');
            
            updateProgress();
        }

        // File Upload System
        function setupFileUpload() {
            const photoUpload = document.getElementById('photoUpload');
            const photoPreview = document.getElementById('photoPreview');
            
            photoUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    handleImageUpload(file);
                }
            });
        }

        function setupDragAndDrop() {
            const uploadArea = document.querySelector('.upload-area');
            
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#44a08d';
                uploadArea.style.backgroundColor = '#e8f5f3';
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#4ecdc4';
                uploadArea.style.backgroundColor = '#f0fffe';
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#4ecdc4';
                uploadArea.style.backgroundColor = '#f0fffe';
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleImageUpload(files[0]);
                }
            });
        }

        function handleImageUpload(file) {
            if (!file.type.startsWith('image/')) {
                alert('Hanya file gambar yang diperbolehkan!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById('photoPreview');
                preview.innerHTML = `
                    <img src="${e.target.result}" alt="Foto hasil karya" class="photo-preview">
                    <div class="success-message">
                        <i class="fas fa-check"></i> Foto berhasil diupload!
                    </div>
                `;
                
                uploadedPhoto = {
                    data: e.target.result,
                    name: file.name,
                    timestamp: new Date().toISOString()
                };
                
                updateProgress();
                saveProgress();
            };
            
            reader.readAsDataURL(file);
        }

        // Progress System
        function updateProgress() {
            const totalTasks = 8; // 5 quiz + 1 pattern + 1 photo + 1 completion
            let completedTasks = 0;
            
            // Count quiz answers
            const quizCount = Object.keys(quizAnswers).length;
            completedTasks += quizCount;
            
            // Count pattern creation
            if (digitalPattern.length > 0) {
                completedTasks += 1;
            }
            
            // Count photo upload
            if (uploadedPhoto) {
                completedTasks += 1;
            }
            
            // Count completion
            if (currentSlide === totalSlides - 1) {
                completedTasks += 1;
            }
            
            const progressPercentage = Math.round((completedTasks / totalTasks) * 100);
            
            document.getElementById('progressFill').style.width = progressPercentage + '%';
            document.getElementById('progressText').textContent = `Progress: ${progressPercentage}%`;
            
            // Update recap
            updateRecap();
        }

        function updateRecap() {
            const quizCount = Object.keys(quizAnswers).length;
            document.getElementById('quizScore').textContent = `${quizCount}/5 Terjawab`;
            
            const patternStatus = digitalPattern.length > 0 ? 
                `${digitalPattern.length} blok tersusun` : 'Belum dibuat';
            document.getElementById('patternScore').textContent = patternStatus;
            
            const photoStatus = uploadedPhoto ? 'Sudah diupload' : 'Belum diupload';
            document.getElementById('photoScore').textContent = photoStatus;
        }

        // Audio System
        function playAudio() {
            const audioBtn = document.getElementById('audioBtn');
            const slideTexts = [
                'Hai, Pembuat Pola Digital Hebat! Pernah main lego atau balok susun? Hari ini kita akan membuat pola keren dengan blok digital!',
                'Blok digital adalah balok warna atau perintah yang bisa disusun di tablet untuk membuat pola atau gerakan.',
                'Pilih blok warna atau perintah di aplikasi seperti Scratch Jr.',
                'Seret blok-blok itu ke layar dan susun pola unikmu sendiri.',
                'Foto pola digital yang sudah kamu buat dan tunjukkan ke guru atau orang tua.',
                'Hari ini kamu belajar membuat pola dari blok digital. Siap buat pola lebih seru di lesson berikutnya?'
            ];
            
            // Simple text-to-speech simulation
            alert(`Audio: ${slideTexts[currentSlide]}`);
        }

        // Storage System
        function saveProgress() {
            const progressData = {
                currentSlide,
                quizAnswers,
                digitalPattern,
                uploadedPhoto,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('craft-coding-l2-progress', JSON.stringify(progressData));
        }

        function loadProgress() {
            const savedData = localStorage.getItem('craft-coding-l2-progress');
            if (savedData) {
                const progressData = JSON.parse(savedData);
                currentSlide = progressData.currentSlide || 0;
                quizAnswers = progressData.quizAnswers || {};
                digitalPattern = progressData.digitalPattern || [];
                uploadedPhoto = progressData.uploadedPhoto || null;
                
                // Restore UI state
                goToSlide(currentSlide);
                restoreQuizAnswers();
                restorePattern();
                restorePhoto();
            }
        }

        function restoreQuizAnswers() {
            Object.keys(quizAnswers).forEach(questionId => {
                const answer = quizAnswers[questionId];
                const options = document.querySelectorAll(`[onclick*="${questionId}"]`);
                options.forEach(option => {
                    if (option.getAttribute('onclick').includes(`'${answer}'`)) {
                        option.classList.add('selected');
                    }
                });
            });
        }

        function restorePattern() {
            if (digitalPattern.length > 0) {
                const workspace = document.getElementById('patternWorkspace');
                workspace.classList.remove('empty');
                workspace.innerHTML = '';
                
                digitalPattern.forEach(block => {
                    const blockElement = document.createElement('div');
                    blockElement.className = `pattern-block block-${block.color}`;
                    blockElement.innerHTML = `
                        ${block.emoji}
                        <button class="remove-btn" onclick="removeBlock(this)">칑</button>
                    `;
                    workspace.appendChild(blockElement);
                });
            }
        }

        function restorePhoto() {
            if (uploadedPhoto) {
                const preview = document.getElementById('photoPreview');
                preview.innerHTML = `
                    <img src="${uploadedPhoto.data}" alt="Foto hasil karya" class="photo-preview">
                    <div class="success-message">
                        <i class="fas fa-check"></i> Foto berhasil diupload!
                    </div>
                `;
            }
        }

        // Utility Functions
        function showSuccessMessage(container, message) {
            const existingMessage = container.querySelector('.success-message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'success-message';
            messageDiv.innerHTML = `<i class="fas fa-check"></i> ${message}`;
            container.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                previousSlide();
            } else if (e.key === 'ArrowRight') {
                nextSlide();
            }
        });
    </script>
</body>
</html>