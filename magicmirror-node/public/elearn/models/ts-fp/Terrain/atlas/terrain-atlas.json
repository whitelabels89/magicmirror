{
  "version": 1,
  "_comment": "Terrain atlas template. Isi koordinat berdasarkan spritesheet Tilemap_color1/2/3. Skema mendukung index linear ATAU koordinat grid (col,row).",

  "tileSize": 64,
  "spacing": 0,
  "margin": 0,

  "variants": {
    "_comment": "Semua varian HARUS punya layout identik (hanya beda palet warna). cols/rows auto dari ukuran gambar.",
    "color1": { "url": "/elearn/models/ts-fp/Terrain/tilesets/Tilemap_color1.png", "cols": null, "rows": null },
    "color2": { "url": "/elearn/models/ts-fp/Terrain/tilesets/Tilemap_color2.png", "cols": null, "rows": null },
    "color3": { "url": "/elearn/models/ts-fp/Terrain/tilesets/Tilemap_color3.png", "cols": null, "rows": null }
  },
  "defaultVariant": "color1",

  "indexing": {
    "_comment": "Pilih cara referensi tile. 'mode': 'grid' artinya pakai (col,row). Jika 'linear', pakai index (0..N-1).",
    "mode": "grid"
  },

  "defaultSkirtDepth": 3,

  "sets": {
    "_comment": "Tiga kelompok utama sesuai aset: ground (flat), cliff di atas air, cliff di atas darat. 'mode: blob47' untuk auto-tiling tepi+corner.",
    "ground": {
      "mode": "blob47",
      "coords": {
        "_comment": "Koordinat Flat Ground (Tilemap_color1.png). Grid 64x64, 20x8. Center & edges & outer corners diisi; inner corners fallback ke center.",
        "center": [2, 2],
        "edges": { "N": [2, 1], "S": [2, 3], "W": [1, 2], "E": [3, 2] },
        "cornersIn": { "NW": [2, 2], "NE": [2, 2], "SE": [2, 2], "SW": [2, 2] },
        "cornersOut": { "NW": [1, 1], "NE": [3, 1], "SE": [3, 3], "SW": [1, 3] },
        "skirt": [2, 4],
        "skirt_end": [2, 5]
      },
      "special": {
        "_comment": "Samakan struktur dengan cliff_* agar engine memilih varian L/M/R pada stroke/area tanpa mengubah perilaku dasar.",
        "single": { "center": [4, 5], "skirt": [4, 6] },
        "area3x3": {
          "topRow":   { "centers": [[1, 1], [2, 1], [3, 1]], "noSkirtOn": ["N","NE","NW","E","W","S","SE","SW"] },
          "midRow":   { "centers": [[1, 2], [2, 2], [3, 2]], "noSkirtOn": ["N","NE","NW","E","W","S","SE","SW"] },
          "bottomRow":{
            "centers": [[1, 3], [2, 3], [3, 3]],
            "skirtRow": [[1, 4], [2, 4], [3, 4]],
            "skirtEndRow": [[1, 4], [2, 4], [3, 4]]
          }
        },
        "vertical":   { "centers": [[4, 1], [4, 2], [4, 3]], "skirt": [4, 4] },
        "horizontal": { "centers": [[1, 5], [2, 5], [3, 5]], "skirtRow": [[1, 6], [2, 6], [3, 6]] }
      }
    },
    "water": {
      "_comment": "Simple water fill. Adjust coords to actual tile if needed.",
      "mode": "blob47",
      "coords": {
        "center": [6, 2],
        "edges": { "N": [6, 2], "S": [6, 2], "W": [6, 2], "E": [6, 2] },
        "cornersIn": { "NW": [6, 2], "NE": [6, 2], "SE": [6, 2], "SW": [6, 2] },
        "cornersOut": { "NW": [6, 2], "NE": [6, 2], "SE": [6, 2], "SW": [6, 2] }
      },
      "auto": {
        "_comment": "Painting water should clear ground on the same cell; erasing restores ground.",
        "companion": [
          { "layer": "ground", "onPaint": "eraseSameCell", "onErase": "fillSameCell" }
        ]
      }
    },
    "cliff_water": {
      "mode": "blob47",
      "skirtDepth": 1,
      "coords": {
        "_comment": "Cliff on Water (Elevation on Water) — blok tengah, center di kolom 9 baris 2.",
        "center": [7, 2],
        "edges": { "N": [7, 1], "S": [7, 3], "W": [6, 2], "E": [8, 2] },
        "cornersIn": { "NW": [6, 1], "NE": [8, 1], "SE": [8, 3], "SW": [6, 3] },
        "cornersOut": { "NW": [6, 1], "NE": [8, 1], "SE": [8, 3], "SW": [6, 3] },
        "skirt": [9, 4],
        "skirt_end": [9, 4]
      },
      "auto": {
        "_comment": "Painting cliff_water converts base to water and clears ground; erasing reverses it.",
        "face": "S",
        "paint": {
          "withSkirt": false,
          "skirtHeight": 3,
          "skirtOffset": [0, 1]
        },
        "companion": [
          { "layer": "water",  "onPaint": "fillSameCell",  "onErase": "eraseSameCell" },
          { "layer": "water",  "onPaint": "fillSameCell",  "onErase": "eraseSameCell", "offset": [0, 1] },
          { "layer": "ground", "onPaint": "eraseSameCell", "onErase": "fillSameCell" },
          { "layer": "ground", "onPaint": "eraseSameCell", "onErase": "fillSameCell", "offset": [0, 1] }
        ]
      },
      "special": {
        "_comment": "Match cliff_land behaviours (single/area/horizontal) but using water tiles (cols 8..10).",
        "single": {
          "center": [9, 5],
          "skirt": [9, 6]
        },
        "area3x3": {
          "topRow": {
            "centers": [[6, 1], [7, 1], [8, 1]],
            "noSkirtOn": ["N", "NE", "NW", "E", "W", "S", "SE", "SW"]
          },
          "midRow": {
            "centers": [[6, 2], [7, 2], [8, 2]],
            "noSkirtOn": ["N", "NE", "NW", "E", "W", "S", "SE", "SW"]
          },
          "bottomRow": {
            "centers": [[6, 3], [7, 3], [8, 3]],
            "skirtRow": [[6, 4], [7, 4], [8, 4]],
            "skirtEndRow": [[6, 4], [7, 4], [8, 4]]
          }
        },
        "vertical": {
          "centers": [[9, 1], [9, 2], [9, 3]],
          "skirt": [9, 4]
        },
        "horizontal": {
          "_comment": "One-tile-high on water: grass/shore line (row5) with foam/rock (row4) below; if row5 not available, mid row (row2) is acceptable.",
          "centers": [[6, 5], [7, 5], [8, 5]],
          "skirtRow": [[6, 6], [7, 6], [8, 6]]
        }
      }
    },
    "cliff_land": {
      "mode": "blob47",
      "skirtDepth": 1,
      "coords": {
        "_comment": "Cliff on Land — CENTER = cliff face repeat (12,4). Top edge = grass-cap (12,2). Sides = (11,4)/(13,4).",
        "center": [12, 4],
        "edges": { "N": [12, 1], "S": [12, 4], "W": [11, 4], "E": [13, 4] },
        "cornersIn": { "NW": [11, 1], "NE": [13, 1], "SE": [12, 4], "SW": [12, 4] },
        "cornersOut": { "NW": [11, 2], "NE": [13, 2], "SE": [13, 4], "SW": [11, 4] },
        "skirt": [12, 5],
        "skirt_end": [12, 5]
      },
      "auto": {
        "_comment": "Directive for engine/demo: when painting cliff_land, also paint skirt and backfill ground.",
        "face": "S",
        "paint": {
          "withSkirt": true,
          "skirtHeight": 3,
          "skirtOffset": [0, 1]
        },
        "companion": {
          "layer": "ground",
          "onPaint": "none",
          "onErase": "eraseSameCell"
        }
      }
      ,
      "special": {
        "_comment": "Custom mapping for single/area/vertical/horizontal behaviours (engine must read this).",
        "single": {
          "center": [14, 5],
          "skirt": [14, 6]
        },
        "area3x3": {
          "_comment": "3x3: rumput menyatu; cliff face hanya di baris bawah; skirt & end-cap sesuai tileset land.",
          "topRow": {
            "_comment": "Use left/mid/right grass-cap tiles so tepi kiri/kanan menyatu.",
            "centers": [[11, 1], [12, 1], [13, 1]],
            "noSkirtOn": ["N", "NE", "NW", "E", "W", "S", "SE", "SW"]
          },
          "midRow": {
            "_comment": "Middle interior uses grass-cap with left/mid/right variants to keep edges blending.",
            "centers": [[11, 2], [12, 2], [13, 2]],
            "noSkirtOn": ["N", "NE", "NW", "E", "W", "S", "SE", "SW"]
          },
          "bottomRow": {
            "_comment": "Bottom shows cliff face L/M/R then skirt below and end-caps at the last skirt tile (same art as skirt for land).",
            "centers": [[11, 3], [12, 3], [13, 3]],
            "skirtRow": [[11, 4], [12, 4], [13, 4]],
            "skirtEndRow": [[11, 4], [12, 4], [13, 4]]
          }
        },
        "vertical": {
          "centers": [[14, 1], [14, 2], [14, 3]],
          "skirt": [14, 4]
        },
        "horizontal": {
          "_comment": "One-tile-high ridge: grass (row5) in ridge cell, rock (row6) one tile below.",
          "centers": [[11, 5], [12, 5], [13, 5]],
          "skirtRow": [[11, 6], [12, 6], [13, 6]]
        }
      }
    },
    
    "slopes": {
      "_comment": "Tangga rumput. stairs.right menghadap ke kanan (naik ke kanan), stairs.left menghadap ke kiri (naik ke kiri).",
      "mode": "explicit",
      "stairs": {
        "right":  [16, 1],
        "right2": [16, 2],
        "left":   [18, 1],
        "left2":  [18, 2]
      }
    }
  },

  "bitmaskDocs": {
    "_comment": "Dokumentasi pemetaan bitmask 8 arah ke edges/corners. Engine akan turunkan dari 'coords'.",
    "neighborsOrder": "N, NE, E, SE, S, SW, W, NW (bit 0..7)",
    "example": {
      "edgeNorth": 1,
      "edgeEast": 4,
      "edgeSouth": 16,
      "edgeWest": 64,
      "innerCornerNE": 2,
      "innerCornerSE": 8,
      "innerCornerSW": 32,
      "innerCornerNW": 128
    }
  }
}
