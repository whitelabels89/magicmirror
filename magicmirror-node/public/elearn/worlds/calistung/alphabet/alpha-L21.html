

<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>alpha21L9 – Tuliskan Kata yang Tepat</title>
  <style>
    :root{
      --bg:#f7f9fc; --ink:#1f2a44; --muted:#6b7280; --ok:#16a34a; --bad:#dc2626; --chip:#ffffff; --chip-bd:#d1d5db; --accent:#2563eb;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Noto Sans", Arial, sans-serif; color:var(--ink); background:var(--bg);}    
    header{padding:18px 14px 8px; text-align:center}
    header h1{margin:0; font-size:clamp(20px,4vw,34px); letter-spacing:.3px}
    header p{margin:6px 0 0; color:var(--muted); font-size:clamp(12px,2.3vw,14px)}

    .wrap{max-width:1100px; margin:0 auto; padding:10px 14px 80px}

    .bank{display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:10px auto 18px}
    .word{user-select:none; padding:10px 12px; border-radius:12px; border:1.5px solid var(--chip-bd); background:var(--chip); cursor:grab; font-weight:600; box-shadow:0 1px 0 rgba(0,0,0,.06)}
    .word.dragging{opacity:.5}

    .grid{display:grid; grid-template-columns:repeat(3,1fr); gap:16px}
    @media (max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:560px){.grid{grid-template-columns:1fr}}

    .card{background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:14px; display:flex; flex-direction:column; align-items:center; gap:10px; box-shadow:0 2px 0 rgba(0,0,0,.03)}
    .icon{font-size:64px; line-height:1; filter: drop-shadow(0 1px 0 rgba(0,0,0,.05))}
    .hint{font-size:12px; color:var(--muted)}

    .dropzone{width:100%;}
    .dropzone input{width:100%; padding:12px 14px; border-radius:12px; border:2px dashed #d1d5db; outline:none; font-size:16px; text-align:center; transition:.2s}
    .dropzone input:focus{border-color:var(--accent); background:#f0f7ff}
    .dropzone input.correct{border-color:var(--ok); background:#ecfdf5}
    .dropzone input.wrong{border-color:var(--bad); background:#fef2f2}

    .actions{position:sticky; bottom:0; left:0; right:0; padding:10px; background:linear-gradient(180deg, rgba(247,249,252,0), var(--bg) 40%)}
    .bar{display:flex; gap:10px; justify-content:center; flex-wrap:wrap}
    button{appearance:none; border:none; border-radius:10px; padding:12px 14px; font-weight:700; cursor:pointer}
    .primary{background:var(--accent); color:#fff}
    .ghost{background:#fff; border:1px solid #e5e7eb}
    .score{font-weight:800; color:var(--accent)}
  </style>
<style>
    .finish-bar { position: fixed; right: 16px; bottom: 16px; z-index: 1000; }
    #btnSelesai { background: #22c55e; color: #fff; border: none; cursor: pointer; padding: 12px 16px; border-radius: 12px; font-weight: 700; font-size: 16px; box-shadow: 0 6px 18px rgba(16, 185, 129, 0.4); }
    #btnSelesai:hover { filter: brightness(1.05); }
    #btnSelesai:active { transform: translateY(1px); }
    @media (max-width: 480px) {
      #btnSelesai { padding: 10px 14px; font-size: 15px; }
    }
  </style>

  <link rel="stylesheet" href="/elearn/worlds/calistung/buttons.css" />
</head>
<body>
  <header>
    <h1>Tuliskan kata yang tepat</h1>
    <p>Seret kata dari bank kata ke kotak jawaban, atau ketik manual. Lalu klik <b>Periksa</b>.</p>
  </header>

  <div class="wrap">
    <div id="bank" class="bank" aria-label="Bank kata"></div>

    <div class="grid" id="grid"></div>
  </div>

  <div class="actions">
    <div class="bar">
      <button id="checkBtn" class="primary">Periksa Jawaban</button>
      <button id="resetBtn" class="ghost">Reset</button>
      <span id="score" class="score" aria-live="polite"></span>
    </div>
  </div>

  <script>
    // Data target: 9 kartu seperti pada worksheet (pakai emoji sebagai ikon pengganti)
    const ITEMS = [
      {key:'kamera', label:'Kamera', icon:'📷'},
      {key:'sepeda', label:'Sepeda', icon:'🚲'},
      {key:'pepaya', label:'Pepaya', icon:'🥭'},
      {key:'celana', label:'Celana', icon:'👖'},
      {key:'kereta', label:'Kereta', icon:'🚂'},
      {key:'istana', label:'Istana', icon:'🏰'},
      {key:'kelapa', label:'Kelapa', icon:'🥥'},
      {key:'kemeja', label:'Kemeja', icon:'👕'},
      {key:'kepala', label:'Kepala', icon:'🧑‍🦲'},
    ];

    // Bank kata sesuai instruksi (acak saat load)
    const WORD_BANK = ['Istana','Kemeja','Kepala','Sepeda','Celana','Kelapa','Pepaya','Kamera','Kereta'];

    const grid = document.getElementById('grid');
    const bank = document.getElementById('bank');
    const scoreEl = document.getElementById('score');

    function shuffle(arr){return arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(v=>v[1]);}

    function createGrid(){
      grid.innerHTML = '';
      ITEMS.forEach((it,idx)=>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="icon" aria-hidden="true">${it.icon}</div>
          <div class="hint">Tulis nama benda</div>
          <div class="dropzone"><input type="text" inputmode="latin" autocomplete="off" spellcheck="false" placeholder="Ketik / drop kata di sini" data-key="${it.key}" aria-label="Jawaban untuk ${it.label}"></div>
        `;
        grid.appendChild(card);
      });
    }

    function renderBank(){
      bank.innerHTML = '';
      shuffle(WORD_BANK).forEach(w=>{
        const chip = document.createElement('div');
        chip.className = 'word';
        chip.textContent = w;
        chip.draggable = true;
        chip.addEventListener('dragstart', e=>{ chip.classList.add('dragging'); e.dataTransfer.setData('text/plain', w); });
        chip.addEventListener('dragend', ()=> chip.classList.remove('dragging'));
        bank.appendChild(chip);
      });
    }

    // Enable dropping onto inputs
    function enableDnD(){
      grid.querySelectorAll('input').forEach(inp=>{
        inp.addEventListener('dragover', e=>{ e.preventDefault(); });
        inp.addEventListener('drop', e=>{ e.preventDefault(); const text = e.dataTransfer.getData('text/plain'); inp.value = text; });
      });
    }

    function normalize(s){return (s||'').toString().trim().toLowerCase();}

    function check(){
      let correct = 0;
      const total = ITEMS.length;
      grid.querySelectorAll('input').forEach(inp=>{
        const expected = normalize(inp.dataset.key);
        const val = normalize(inp.value);
        const ok = val === expected;
        inp.classList.remove('correct','wrong');
        inp.classList.add(ok ? 'correct' : 'wrong');
        if(ok) correct++;
      });
      scoreEl.textContent = `Skor: ${correct}/${total}`;
    }

    function resetAll(){
      grid.querySelectorAll('input').forEach(inp=>{ inp.value=''; inp.classList.remove('correct','wrong'); });
      scoreEl.textContent='';
      renderBank();
      enableDnD();
    }

    // Init
    createGrid();
    renderBank();
    enableDnD();

    // Buttons – boleh diklik berkali-kali (tidak akan macet)
    document.getElementById('checkBtn').addEventListener('click', check);
    document.getElementById('resetBtn').addEventListener('click', resetAll);
  </script>
<div class="finish-bar"><button id="btnSelesai" type="button">Selesai</button></div>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="/elearn/manifest-lessons.js"></script>
<script src="/elearn/userInfo.js"></script>
<script src="/elearn/common/worksheet-submit.js"></script>
<script>
  window.WORKSHEET_DEBUG = true;
  const info = (typeof getUserInfo === "function") ? getUserInfo() : {};
  initWorksheetSubmit({
    muridUid: info.uid || "",
    cid: info.cid || "",
    namaAnak: info.nama || "",
    role: (info.role || "").toLowerCase()
  });
</script>
</body>
</html>