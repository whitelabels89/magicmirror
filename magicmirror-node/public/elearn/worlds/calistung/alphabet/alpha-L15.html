<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alpha15 â€¢ Tebak Huruf dari Warna</title>
  <link rel="stylesheet" href="theme.css" />
  <script defer src="theme.js"></script>
  <style>
    :root {
      --bg: #f4f2ff;
      --card: #ffffff;
      --accent: #7c3aed;
      --ink: #1f2937;
      --muted: #6b7280;
      --good: #16a34a;
      --bad: #ef4444;
      --shadow: 0 26px 60px rgba(124, 58, 237, 0.16);
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', sans-serif;
      background: radial-gradient(circle at top, rgba(124, 58, 237, 0.12), transparent 60%), var(--bg);
      color: var(--ink);
      min-height: 100svh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: clamp(16px, 4vw, 40px);
    }
    main {
      width: min(1024px, 100%);
      background: var(--card);
      border-radius: 32px;
      box-shadow: var(--shadow);
      padding: clamp(22px, 4vw, 36px);
      display: grid;
      gap: clamp(18px, 4vw, 30px);
    }
    header { text-align: center; }
    h1 {
      margin: 0;
      font-size: clamp(24px, 5vw, 38px);
      font-weight: 800;
      color: var(--accent);
    }
    p.lead {
      margin: 10px auto 0;
      max-width: 600px;
      color: var(--muted);
      font-size: clamp(15px, 2.7vw, 18px);
      line-height: 1.6;
    }
    .legend {
      display: grid;
      gap: 12px;
    }
    .legend-title {
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: .4px;
      color: rgba(124, 58, 237, 0.9);
      font-size: clamp(14px, 2.4vw, 16px);
    }
    .legend-grid {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(84px, 1fr));
    }
    .legend-item {
      text-align: center;
      font-weight: 700;
      color: #4b5563;
    }
    .circle {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      display: grid;
      place-items: center;
      font-size: 22px;
      font-weight: 800;
      color: #111827;
      border: 4px solid rgba(17, 24, 39, 0.08);
      margin: 0 auto 6px;
    }
    .worksheet {
      display: grid;
      gap: clamp(16px, 3vw, 22px);
    }
    .question {
      display: grid;
      gap: 14px;
      padding: clamp(16px, 3.2vw, 24px);
      border-radius: 24px;
      background: linear-gradient(180deg, rgba(124, 58, 237, 0.06), rgba(124, 58, 237, 0));
      border: 1px solid rgba(124, 58, 237, 0.12);
      position: relative;
      overflow: hidden;
    }
    .question::after {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      border-radius: inherit;
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.3);
    }
    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .chips .circle { width: 58px; height: 58px; font-size: 20px; }
    .answer-box {
      display: grid;
      gap: 8px;
      justify-items: center;
    }
    .answer-box input {
      width: min(220px, 80%);
      border-radius: 16px;
      border: 2px solid rgba(79, 70, 229, 0.16);
      padding: 12px 16px;
      font-size: 18px;
      font-weight: 700;
      text-align: center;
      text-transform: lowercase;
      transition: border-color .2s ease, box-shadow .2s ease, background-color .2s ease;
    }
    .answer-box input.correct {
      border-color: var(--good);
      background: #ecfdf3;
      box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.18);
    }
    .answer-box input.wrong {
      border-color: var(--bad);
      background: #fef2f2;
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.18);
    }
    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      justify-content: center;
    }
    .actions button {
      min-width: clamp(150px, 30vw, 220px);
    }
    #status {
      text-align: center;
      font-weight: 700;
      color: var(--accent);
      min-height: 24px;
    }
    #status.ok { color: var(--good); }
    #status.warn { color: var(--bad); }

    @media (max-width: 600px) {
      .circle { width: 56px; height: 56px; }
      .chips .circle { width: 50px; height: 50px; font-size: 18px; }
      .question { border-radius: 18px; }
    }
  </style>
  <style>
    .finish-bar { position: fixed; right: 16px; bottom: 16px; z-index: 1000; }
    #btnSelesai { background: #22c55e; color: #fff; border: none; cursor: pointer; padding: 12px 16px; border-radius: 12px; font-weight: 700; font-size: 16px; box-shadow: 0 6px 18px rgba(16, 185, 129, 0.4); }
    #btnSelesai:hover { filter: brightness(1.05); }
    #btnSelesai:active { transform: translateY(1px); }
    @media (max-width: 480px) {
      #btnSelesai { padding: 10px 14px; font-size: 15px; }
    }
  </style>
  <link rel="stylesheet" href="/elearn/worlds/calistung/buttons.css" />
</head>
<body class="alphabet-game">
  <main aria-live="polite">
    <header>
      <h1>Tebak Huruf dari Warna</h1>
      <p class="lead">Setiap warna mewakili huruf tertentu. Perhatikan daftar warna, lalu tuliskan kata sesuai warna pada barisan lingkaran.</p>
    </header>

    <section class="legend" aria-label="Daftar warna dan huruf">
      <div class="legend-title">Petunjuk Warna</div>
      <div id="legendGrid" class="legend-grid">
        <div class="legend-item" data-letter="b">
          <div class="circle" style="background:#f97316">B</div>
          <div>= b</div>
        </div>
        <div class="legend-item" data-letter="a">
          <div class="circle" style="background:#facc15">A</div>
          <div>= a</div>
        </div>
        <div class="legend-item" data-letter="l">
          <div class="circle" style="background:#60a5fa">L</div>
          <div>= l</div>
        </div>
        <div class="legend-item" data-letter="i">
          <div class="circle" style="background:#c084fc">I</div>
          <div>= i</div>
        </div>
        <div class="legend-item" data-letter="k">
          <div class="circle" style="background:#fda4af">K</div>
          <div>= k</div>
        </div>
        <div class="legend-item" data-letter="u">
          <div class="circle" style="background:#34d399">U</div>
          <div>= u</div>
        </div>
        <div class="legend-item" data-letter="s">
          <div class="circle" style="background:#fb7185">S</div>
          <div>= s</div>
        </div>
      </div>
    </section>

    <section id="worksheet" class="worksheet" aria-label="Daftar soal">
      <article class="question" data-answer="bali">
        <div class="chips">
          <div class="circle" style="background:#f97316" title="Huruf B"></div>
          <div class="circle" style="background:#facc15" title="Huruf A"></div>
          <div class="circle" style="background:#60a5fa" title="Huruf L"></div>
          <div class="circle" style="background:#c084fc" title="Huruf I"></div>
        </div>
        <div class="answer-box">
          <input type="text" autocomplete="off" spellcheck="false" aria-label="Jawaban untuk warna kata 4 huruf" />
          <small style="color:var(--muted); font-weight:600">Tulis kata di sini</small>
        </div>
      </article>
      <article class="question" data-answer="balik">
        <div class="chips">
          <div class="circle" style="background:#f97316" title="Huruf B"></div>
          <div class="circle" style="background:#facc15" title="Huruf A"></div>
          <div class="circle" style="background:#60a5fa" title="Huruf L"></div>
          <div class="circle" style="background:#c084fc" title="Huruf I"></div>
          <div class="circle" style="background:#fda4af" title="Huruf K"></div>
        </div>
        <div class="answer-box">
          <input type="text" autocomplete="off" spellcheck="false" aria-label="Jawaban untuk warna kata 5 huruf" />
          <small style="color:var(--muted); font-weight:600">Tulis kata di sini</small>
        </div>
      </article>
      <article class="question" data-answer="buku">
        <div class="chips">
          <div class="circle" style="background:#f97316" title="Huruf B"></div>
          <div class="circle" style="background:#34d399" title="Huruf U"></div>
          <div class="circle" style="background:#f97316" title="Huruf B"></div>
          <div class="circle" style="background:#34d399" title="Huruf U"></div>
        </div>
        <div class="answer-box">
          <input type="text" autocomplete="off" spellcheck="false" aria-label="Jawaban untuk warna kata 4 huruf" />
          <small style="color:var(--muted); font-weight:600">Tulis kata di sini</small>
        </div>
      </article>
      <article class="question" data-answer="saku">
        <div class="chips">
          <div class="circle" style="background:#fb7185" title="Huruf S"></div>
          <div class="circle" style="background:#f97316" title="Huruf A"></div>
          <div class="circle" style="background:#fda4af" title="Huruf K"></div>
          <div class="circle" style="background:#34d399" title="Huruf U"></div>
        </div>
        <div class="answer-box">
          <input type="text" autocomplete="off" spellcheck="false" aria-label="Jawaban untuk warna kata 4 huruf" />
          <small style="color:var(--muted); font-weight:600">Tulis kata di sini</small>
        </div>
      </article>
    </section>

    <div class="actions">
      <button type="button" id="btnCheck">Periksa Jawaban</button>
      <button type="button" id="btnReset">Reset</button>
      <button type="button" id="btnShuffle">Acak Soal</button>
    </div>
    <div id="status" role="status"></div>
  </main>

  <div class="finish-bar"><button id="btnSelesai" type="button">Selesai</button></div>

  <script>
    (function(){
      const PUZZLES = [
        {
          mapping: {
            b: '#f97316',
            a: '#facc15',
            l: '#60a5fa',
            i: '#c084fc',
            k: '#fda4af',
            u: '#34d399',
            s: '#fb7185'
          },
          words: ['bali', 'balik', 'buku', 'saku']
        },
        {
          mapping: {
            p: '#f9a8d4',
            i: '#38bdf8',
            s: '#fcd34d',
            a: '#86efac',
            n: '#f87171',
            g: '#c4b5fd'
          },
          words: ['pisang', 'singa', 'pagi', 'asin']
        },
        {
          mapping: {
            k: '#facc15',
            o: '#38bdf8',
            p: '#fb7185',
            i: '#a855f7',
            t: '#f97316',
            e: '#34d399',
            a: '#fde68a'
          },
          words: ['kopi', 'topi', 'kota', 'tepi']
        }
      ];

      const legendGrid = document.getElementById('legendGrid');
      const worksheet = document.getElementById('worksheet');
      const statusEl = document.getElementById('status');
      const btnCheck = document.getElementById('btnCheck');
      const btnReset = document.getElementById('btnReset');
      const btnShuffle = document.getElementById('btnShuffle');

      let currentPuzzle = 0;

      function renderPuzzle(index){
        const puzzle = PUZZLES[index];
        renderLegend(puzzle.mapping);
        renderQuestions(puzzle);
        setStatus('Soal siap! Tulis jawabannya ya ðŸ˜Š', '');
      }

      function renderLegend(mapping){
        legendGrid.innerHTML = '';
        Object.keys(mapping).sort().forEach(letter => {
          const item = document.createElement('div');
          item.className = 'legend-item';
          const circle = document.createElement('div');
          circle.className = 'circle';
          circle.style.background = mapping[letter];
          circle.textContent = letter.toUpperCase();
          const label = document.createElement('div');
          label.textContent = `= ${letter}`;
          item.append(circle, label);
          legendGrid.appendChild(item);
        });
      }

      function renderQuestions(puzzle){
        worksheet.innerHTML = '';
        puzzle.words.forEach(word => {
          const row = document.createElement('article');
          row.className = 'question';
          row.dataset.answer = word;

          const chips = document.createElement('div');
          chips.className = 'chips';
          [...word].forEach(letter => {
            const circle = document.createElement('div');
            circle.className = 'circle';
            circle.style.background = puzzle.mapping[letter];
            circle.title = `Huruf ${letter.toUpperCase()}`;
            chips.appendChild(circle);
          });

          const answerBox = document.createElement('div');
          answerBox.className = 'answer-box';
          const input = document.createElement('input');
          input.type = 'text';
          input.setAttribute('autocomplete', 'off');
          input.setAttribute('spellcheck', 'false');
          input.setAttribute('aria-label', `Jawaban untuk warna kata ${word.length} huruf`);
          input.addEventListener('input', () => {
            input.value = input.value.replace(/[^a-zA-Z]/g, '').toLowerCase();
            input.classList.remove('correct', 'wrong');
            row.removeAttribute('data-state');
            setStatus('', '');
          });
          const caption = document.createElement('small');
          caption.textContent = 'Tulis kata di sini';
          caption.style.color = 'var(--muted)';
          caption.style.fontWeight = '600';
          answerBox.append(input, caption);

          row.append(chips, answerBox);
          worksheet.appendChild(row);
        });
      }

      function checkAnswers(){
        const rows = [...worksheet.querySelectorAll('.question')];
        if(rows.length === 0){
          setStatus('Belum ada soal. Tekan "Acak Soal" dulu ya!', 'warn');
          return;
        }

        let correct = 0;
        rows.forEach(row => {
          const input = row.querySelector('input');
          const answer = (input.value || '').trim().toLowerCase();
          const expected = row.dataset.answer;
          input.classList.remove('correct', 'wrong');
          row.dataset.state = '';
          if(answer === expected){
            input.classList.add('correct');
            row.dataset.state = 'correct';
            correct++;
          } else {
            input.classList.add('wrong');
            row.dataset.state = 'wrong';
          }
        });

        if(correct === rows.length){
          setStatus(`Hebat! Semua benar (${correct}/${rows.length}).`, 'ok');
        } else {
          setStatus(`Benar ${correct} dari ${rows.length} kata. Ayo coba lagi!`, 'warn');
        }
      }

      function resetAnswers(){
        worksheet.querySelectorAll('input').forEach(input => {
          input.value = '';
          input.classList.remove('correct', 'wrong');
        });
        worksheet.querySelectorAll('.question').forEach(row => row.removeAttribute('data-state'));
        setStatus('Jawaban dikosongkan.', '');
      }

      function shufflePuzzle(){
        currentPuzzle = (currentPuzzle + 1) % PUZZLES.length;
        renderPuzzle(currentPuzzle);
      }

      function setStatus(text, state){
        statusEl.textContent = text;
        statusEl.className = '';
        if(state){
          statusEl.classList.add(state);
        }
      }

      btnCheck.addEventListener('click', checkAnswers);
      btnReset.addEventListener('click', resetAnswers);
      btnShuffle.addEventListener('click', shufflePuzzle);

      renderPuzzle(currentPuzzle);
    })();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="/elearn/manifest-lessons.js"></script>
  <script src="/elearn/userInfo.js"></script>
  <script src="/elearn/common/worksheet-submit.js"></script>
  <script>
    window.WORKSHEET_DEBUG = true;
    const info = (typeof getUserInfo === "function") ? getUserInfo() : {};
    initWorksheetSubmit({
      muridUid: info.uid || "",
      cid: info.cid || "",
      namaAnak: info.nama || "",
      role: (info.role || "").toLowerCase()
    });
  </script>
  <script src="/elearn/common/calistung-navbar.js"></script>
</body>
</html>
