<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MG-L7 — Mewarnai Hasil Penjumlahan</title>
  <style>
    :root{
      --c9:#e74c3c; /* merah */
      --c8:#2ecc71; /* hijau */
      --c7:#3498db; /* biru */
      --c6:#f1c40f; /* kuning */
      --ink:#222;
      --bg:#fff;
      --muted:#555;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Noto Sans',sans-serif;background:var(--bg);color:var(--ink);}
    header{padding:16px 20px;border-bottom:1px solid #eee;display:flex;gap:14px;align-items:center;flex-wrap:wrap}
    header h1{font-size:18px;margin:0;font-weight:800}
    header .legend{display:flex;gap:12px;align-items:center;margin-left:auto}
    .dot{
      position:relative;
      width:56px;height:56px;border-radius:16px;display:inline-grid;place-items:center;
      border:none; font-weight:900; font-size:18px; color:#111; user-select:none; cursor:pointer;
      box-shadow:0 6px 0 #111, 0 12px 16px rgba(0,0,0,.18);
      transition:transform .08s ease, box-shadow .15s ease, filter .15s ease;
      outline:none;
    }
    .dot:hover{filter:brightness(1.05)}
    .dot:active{transform:translateY(2px); box-shadow:0 4px 0 #111, 0 8px 12px rgba(0,0,0,.22)}
    .dot[aria-selected="true"]{transform:translateY(2px); box-shadow:0 4px 0 #111, 0 8px 12px rgba(0,0,0,.22); outline:3px dashed #111; outline-offset:3px}

    /* Gradien khusus per nilai agar terlihat seperti tombol game */
    .dot[data-val="9"]{background:linear-gradient(180deg,#ff7b6b,#e74c3c);}   /* merah */
    .dot[data-val="8"]{background:linear-gradient(180deg,#6ee7a0,#2ecc71);}   /* hijau */
    .dot[data-val="7"]{background:linear-gradient(180deg,#79c6ff,#3498db);}   /* biru */
    .dot[data-val="6"]{background:linear-gradient(180deg,#ffe470,#f1c40f);}   /* kuning */

    /* highlight kilau kecil */
    .dot::before{content:""; position:absolute; left:10px; top:8px; width:36px; height:18px; background:rgba(255,255,255,.45); border-radius:999px; filter:blur(6px)}
    .controls{padding:12px 20px;display:flex;gap:10px;flex-wrap:wrap;border-bottom:1px solid #eee}

    /* --- Game Buttons --- */
    .btn{position:relative; display:inline-block; border:none; outline:none; cursor:pointer; font-weight:800; letter-spacing:.2px; padding:10px 16px; border-radius:14px; transition:transform .08s ease, box-shadow .2s ease; box-shadow:0 6px 0 #111, 0 10px 16px rgba(0,0,0,.12); color:#111}
    .btn:active{transform:translateY(2px); box-shadow:0 4px 0 #111, 0 6px 10px rgba(0,0,0,.18)}
    .btn:focus-visible{outline:3px dashed #111; outline-offset:3px}

    .btn-primary{background:linear-gradient(180deg,#ffd75a,#ffb300);}
    .btn-primary:hover{filter:brightness(1.05)}

    .btn-check{background:linear-gradient(180deg,#6ee7b7,#34d399);} 
    .btn-check:hover{filter:brightness(1.05)}

    .btn-reset{background:linear-gradient(180deg,#d1d5db,#9ca3af);} 
    .btn-reset:hover{filter:brightness(1.05)}

    /* small shine */
    .btn:before{content:""; position:absolute; left:10px; top:6px; width:40%; height:35%; background:rgba(255,255,255,.45); border-radius:999px; filter:blur(6px)}

    /*
    button{appearance:none;border:2px solid #111;background:#fff;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer}
    button:active{transform:translateY(1px)}
    */
    #wrap{display:grid;place-items:center;padding:20px}
    svg{max-width:100%;height:auto}
    .seg{fill:#fff;stroke:#111;stroke-width:6;cursor:pointer;transition:filter .15s}
    .seg:hover{filter:brightness(0.98)}
    .sum{
      font-size:32px;
      font-weight:900;
      fill:#222;
      text-anchor:middle;
      dominant-baseline:middle;
      pointer-events:none;      /* klik tetap ke ellipsenya */
    }
    .foot{fill:#111}
    .msg{padding:10px 16px;margin:10px 20px;border-radius:10px;background:#f6f7f9;color:#333}
    .ok{background:#e9f8ef}
    .bad{background:#fff3f3}
    .pill{display:inline-block;padding:4px 8px;border-radius:999px;border:2px solid #111;background:#fff;font-weight:700}
  </style>
</head>
<body>
  <header>
    <h1>Mewarnai Hasil Penjumlahan</h1>
    <div class="legend" id="palette" aria-label="Pilih warna untuk angka hasil">
      <div class="dot" data-val="9" style="background:var(--c9)" role="button" title="9">9</div>
      <div class="dot" data-val="8" style="background:var(--c8)" role="button" title="8">8</div>
      <div class="dot" data-val="7" style="background:var(--c7)" role="button" title="7">7</div>
      <div class="dot" data-val="6" style="background:var(--c6)" role="button" title="6">6</div>
    </div>
  </header>

  <div class="controls">
    <button id="btnShuffle" class="btn btn-primary" title="Acak soal">Acak Soal</button>
    <button id="btnCheck" class="btn btn-check" title="Periksa jawaban">Periksa Jawaban</button>
    <button id="btnReset" class="btn btn-reset" title="Reset warna">Reset Warna</button>
    <span class="pill">Pilihan warna aktif: <b id="activeColor">—</b></span>
  </div>

  <div id="wrap">
    <!-- SVG ulat sederhana (kepala + 5 segmen tubuh) -->
    <svg id="game" viewBox="-140 0 1240 420" preserveAspectRatio="xMidYMid meet">
      <!-- kepala -->
      <ellipse cx="680" cy="160" rx="120" ry="100" fill="#fff" stroke="#111" stroke-width="6"></ellipse>
      <!-- antena dengan ujung bulat -->
      <path d="M645 78 q-20 -18 0 -36" fill="none" stroke="#111" stroke-width="10" stroke-linecap="round"/>
      <circle cx="639" cy="42" r="16" fill="#111"/>
      <path d="M715 78 q20 -18 0 -36" fill="none" stroke="#111" stroke-width="10" stroke-linecap="round"/>
      <circle cx="721" cy="42" r="16" fill="#111"/>
      <!-- alis (diposisikan tepat di atas masing-masing mata) -->
      <path d="M625 118 Q 645 100 665 118" fill="none" stroke="#111" stroke-width="6" stroke-linecap="round"/>
      <path d="M695 118 Q 715 100 735 118" fill="none" stroke="#111" stroke-width="6" stroke-linecap="round"/>
      <!-- mata (oval) yang lebih renggang -->
      <ellipse cx="645" cy="150" rx="18" ry="24" fill="#fff" stroke="#111" stroke-width="6"/>
      <ellipse cx="715" cy="150" rx="18" ry="24" fill="#fff" stroke="#111" stroke-width="6"/>
      <!-- pupil -->
      <ellipse cx="639" cy="146" rx="8" ry="12" fill="#111"/>
      <ellipse cx="709" cy="146" rx="8" ry="12" fill="#111"/>
      <!-- senyum -->
      <path d="M640 190 q40 30 90 0" fill="none" stroke="#111" stroke-width="6" stroke-linecap="round"/>

      <!-- segmen tubuh (5 buah) -->
      <ellipse class="seg" id="seg1" cx="560" cy="260" rx="95" ry="80" data-ans="" />
      <ellipse class="seg" id="seg2" cx="440" cy="290" rx="110" ry="90" data-ans="" />
      <ellipse class="seg" id="seg3" cx="300" cy="300" rx="120" ry="95" data-ans="" />
      <ellipse class="seg" id="seg4" cx="160" cy="320" rx="125" ry="95" data-ans="" />
      <ellipse class="seg" id="seg5" cx="60"  cy="340" rx="90"  ry="70" data-ans="" />

      <!-- kaki -->
      <ellipse class="foot" cx="520" cy="355" rx="20" ry="12" />
      <ellipse class="foot" cx="410" cy="375" rx="22" ry="13" />
      <ellipse class="foot" cx="270" cy="385" rx="22" ry="13" />
      <ellipse class="foot" cx="130" cy="395" rx="22" ry="13" />

      <!-- label penjumlahan -->
      <text class="sum" id="t1" x="570" y="260" dx="20"></text>
      <text class="sum" id="t2" x="450" y="290" dx="20"></text>
      <text class="sum" id="t3" x="310" y="300" dx="20"></text>
      <text class="sum" id="t4" x="170" y="320" dx="20"></text>
      <text class="sum" id="t5" x="40"  y="340" dx="20"></text>
    </svg>
  </div>

  <div class="msg" id="status">Pilih warna (6,7,8,9) lalu klik segmen tubuh ulat sesuai hasil penjumlahan.</div>

  <script>
    // ===== Util warna =====
    const colorMap = {6:'var(--c6)',7:'var(--c7)',8:'var(--c8)',9:'var(--c9)'};

    // ===== Bank soal (hasil 6..9) =====
    const BANK = {
      6: ['4+2','2+4','1+5','5+1','3+3'],
      7: ['2+5','5+2','3+4','4+3','1+6','6+1'],
      8: ['4+4','3+5','5+3','2+6','6+2','1+7','7+1'],
      9: ['6+3','3+6','5+4','4+5','2+7','7+2','1+8','8+1']
    };

    const segIds = ['seg1','seg2','seg3','seg4','seg5'];
    const textIds = ['t1','t2','t3','t4','t5'];

    let active = null; // angka 6/7/8/9 yang dipilih

    function pick(arr,n){
      const a=[...arr];
      for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}
      return a.slice(0,n);
    }

    function parseSum(str){
      const [a,b]=str.split('+').map(Number);return a+b;
    }

    function assignProblems(){
      // kita ingin campuran hasil 6..9 secara acak ke 5 segmen
      const results = [6,7,8,9,6,7,8,9];
      results.sort(()=>Math.random()-0.5);
      // pakai 5 pertama
      const chosen = results.slice(0,5);

      chosen.forEach((res,idx)=>{
        const probs = BANK[res];
        const eq = pick(probs,1)[0];
        const seg = document.getElementById(segIds[idx]);
        const t   = document.getElementById(textIds[idx]);
        seg.dataset.ans = res;
        seg.style.fill = '#fff';
        t.textContent = eq;
      });
    }

    function selectColor(val){
      active = val;
      document.querySelectorAll('.dot').forEach(d=>d.setAttribute('aria-selected', d.dataset.val==val ? 'true':'false'));
      document.getElementById('activeColor').textContent = val ?? '—';
    }

    function paintSegment(e){
      const seg = e.target.closest('.seg');
      if(!seg || !active) return;
      seg.style.fill = colorMap[active];
      seg.dataset.user = active;
    }

    function resetPaint(){
      document.querySelectorAll('.seg').forEach(s=>{s.style.fill='#fff'; s.removeAttribute('data-user');});
      document.getElementById('status').className='msg';
      document.getElementById('status').textContent='Warna direset. Pilih warna lalu isi kembali.';
    }

    function check(){
      let ok=0, total=segIds.length;
      document.querySelectorAll('.seg').forEach(s=>{
        if(String(s.dataset.user)===String(s.dataset.ans)) ok++;
      });
      const st = document.getElementById('status');
      if(ok===total){
        st.className='msg ok';
        st.textContent = 'Mantap! Semua benar 🎉';
      }else{
        st.className='msg bad';
        st.textContent = `Masih ada yang salah: ${ok}/${total} benar. Cek lagi ya!`;
      }
    }

    // events palette
    document.getElementById('palette').addEventListener('click', (e)=>{
      const dot=e.target.closest('.dot');
      if(!dot) return; selectColor(dot.dataset.val);
    });

    // events segmen
    document.getElementById('game').addEventListener('click', paintSegment);

    document.getElementById('btnReset').addEventListener('click', resetPaint);
    document.getElementById('btnCheck').addEventListener('click', check);
    document.getElementById('btnShuffle').addEventListener('click', ()=>{
      assignProblems();
      document.getElementById('status').className='msg';
      document.getElementById('status').textContent='Soal diacak 🎲. Warna tetap tersetel ulang untuk segmen yang berganti.';
      resetPaint();
    });

    // init
    assignProblems();
    selectColor(null); // belum pilih
  </script>
    <button id="finishBtn-L7" style="margin-top: 20px; padding: 10px; background-color: green; color: white;">Selesai</button>
<script>
document.getElementById("finishBtn-L7").addEventListener("click", function() {
  alert("Level selesai!");
  fetch("/elearn/worlds/calistung/math-game/config.json")
    .then(() => console.log("progress saved"));
  window.location.href = "/elearn/worlds/calistung/math-game/index.html";
});
</script>
</body>
</html>
